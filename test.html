<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>人格与星座综合测试</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            text-align: center;
            padding: 30px 20px;
        }
        h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .subtitle {
            font-size: 1em;
            opacity: 0.9;
        }
        .content {
            padding: 30px 20px;
        }
        .page {
            display: none; /* 默认隐藏所有页面 */
        }
        .page.active {
            display: block; /* 显示当前活动页面 */
        }
        .progress {
            height: 4px;
            background: #e9ecef;
            border-radius: 2px;
            margin: 20px 0;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            width: 0%;
            transition: width 0.3s ease;
        }
        .form-group {
            margin-bottom: 25px;
        }
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 1.1em;
        }
        .date-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }
        .date-input:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.2);
        }
        .question {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 18px;
            border-left: 4px solid #4facfe;
            transition: transform 0.2s ease;
        }
        .question:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .question h3 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.2em;
        }
        .options {
            display: flex;
            gap: 15px;
            margin-top: 12px;
        }
        .option {
            flex: 1;
            padding: 10px 12px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-weight: 500;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }
        .option:hover {
            border-color: #4facfe;
            background: #f0f7ff;
        }
        .option.selected {
            border-color: #4facfe;
            background: #e3f2fd;
            color: #1976d2;
            font-weight: 600;
        }
        .tag-section {
            background: #f8f9ff;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 4px solid #4facfe;
        }
        .section-title {
            font-size: 1.4em;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .section-title i {
            margin-right: 10px;
            font-size: 1.2em;
        }
        .tag-group {
            margin-bottom: 20px;
        }
        .tag-group h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
        }
        .tag-group h3 i {
            margin-right: 8px;
            font-size: 1.2em;
        }
        .tag-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }
        .tag-option {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 10px 8px;
            text-align: center;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }
        .tag-option:hover {
            border-color: #4facfe;
            background: #f0f7ff;
        }
        .tag-option.selected {
            border-color: #4facfe;
            background: #e3f2fd;
            color: #1976d2;
            font-weight: 600;
        }
        .tag-option.single-selected {
            background: #4facfe;
            color: white;
            border-color: #4facfe;
        }
        .btn-group {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
        }
        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 30px;
            font-size: 1.1em;
            border-radius: 40px;
            cursor: pointer;
            display: block;
            margin: 0;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
            width: 100%;
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 20px rgba(102, 126, 234, 0.4);
        }
        .submit-btn:active {
            transform: translateY(0);
        }
        .back-btn {
            background: #6c757d;
            box-shadow: 0 8px 16px rgba(108, 117, 125, 0.3);
        }
        .back-btn:hover {
            background: #5a6268;
        }
        .results {
            background: #f8f9ff;
            border-radius: 12px;
            padding: 25px;
            margin-top: 25px;
            border: 2px solid #e9ecef;
        }
        .results h2 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.6em;
        }
        .result-item {
            margin-bottom: 20px;
            padding: 16px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.08);
        }
        .result-item h3 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.2em;
            padding-bottom: 6px;
            border-bottom: 2px solid #f0f0f0;
        }
        .bar-container {
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        .bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            text-align: center;
            color: white;
            line-height: 20px;
            font-size: 0.85em;
            font-weight: 500;
            transition: width 1.5s ease-in-out;
        }
        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        .tag {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.85em;
            font-weight: 500;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .dimension-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
            font-size: 0.9em;
        }
        .dimension-table th {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            text-align: left;
            padding: 10px;
            font-weight: 600;
        }
        .dimension-table td {
            padding: 8px 10px;
            border-bottom: 1px solid #eee;
        }
        .dimension-table tr:nth-child(even) {
            background-color: #f8f9ff;
        }
        .high-score {
            color: #d32f2f;
            font-weight: 600;
        }
        .low-score {
            color: #1976d2;
            font-weight: 600;
        }
        .special-mechanism {
            background: #e8f5e8;
            padding: 10px;
            border-radius: 6px;
            margin: 12px 0;
            border-left: 3px solid #4caf50;
        }
        .special-mechanism h4 {
            color: #2e7d32;
            margin-bottom: 6px;
            font-size: 0.95em;
        }
        .special-mechanism p {
            color: #388e3c;
            font-size: 0.85em;
            margin: 0;
        }
        /* 平板适配 */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            header {
                padding: 25px 15px;
            }
            h1 {
                font-size: 2em;
            }
            .subtitle {
                font-size: 0.95em;
            }
            .content {
                padding: 25px 15px;
            }
            .question {
                padding: 18px;
                margin-bottom: 15px;
            }
            .question h3 {
                font-size: 1.15em;
            }
            .options {
                gap: 12px;
            }
            .option {
                padding: 9px 10px;
                font-size: 0.9em;
            }
            .submit-btn {
                padding: 13px 25px;
                font-size: 1em;
            }
            .results {
                padding: 20px;
                margin-top: 20px;
            }
            .results h2 {
                font-size: 1.5em;
            }
            .result-item {
                padding: 14px;
            }
            .result-item h3 {
                font-size: 1.15em;
            }
            .bar-container {
                height: 18px;
            }
            .bar {
                line-height: 18px;
                font-size: 0.8em;
            }
            .tags {
                gap: 6px;
            }
            .tag {
                padding: 5px 10px;
                font-size: 0.8em;
            }
            .dimension-table {
                font-size: 0.85em;
            }
            .dimension-table th, .dimension-table td {
                padding: 6px 8px;
            }
            .special-mechanism {
                padding: 8px;
            }
            .special-mechanism h4 {
                font-size: 0.95em;
            }
            .progress {
                height: 4px;
                margin: 15px 0;
            }
        }
        /* 手机适配 */
        @media (max-width: 480px) {
            body {
                padding: 15px 10px;
            }
            .container {
                margin: 5px;
                border-radius: 12px;
            }
            header {
                padding: 20px 10px;
            }
            h1 {
                font-size: 1.8em;
            }
            .subtitle {
                font-size: 0.9em;
            }
            .content {
                padding: 20px 10px;
            }
            .question {
                padding: 15px;
                margin-bottom: 15px;
            }
            .question h3 {
                font-size: 1.1em;
            }
            .options {
                flex-direction: column;
                gap: 10px;
            }
            .option {
                padding: 12px 10px;
                font-size: 1em;
            }
            .submit-btn {
                padding: 14px 20px;
                font-size: 1.1em;
                width: 100%;
            }
            .results {
                padding: 18px;
                margin-top: 20px;
            }
            .results h2 {
                font-size: 1.4em;
            }
            .result-item {
                padding: 12px;
            }
            .result-item h3 {
                font-size: 1.1em;
            }
            .bar-container {
                height: 18px;
            }
            .bar {
                line-height: 18px;
                font-size: 0.8em;
            }
            .tags {
                gap: 6px;
            }
            .tag {
                padding: 5px 10px;
                font-size: 0.8em;
            }
            .dimension-table {
                font-size: 0.85em;
            }
            .dimension-table th, .dimension-table td {
                padding: 6px 8px;
            }
            .special-mechanism {
                padding: 8px;
            }
            .special-mechanism h4 {
                font-size: 0.95em;
            }
            .progress {
                height: 4px;
                margin: 15px 0;
            }
        }
        /* 小屏幕特殊优化 */
        @media (max-width: 360px) {
            body {
                padding: 10px;
            }
            .container {
                margin: 5px;
            }
            header {
                padding: 15px 8px;
            }
            h1 {
                font-size: 1.6em;
            }
            .subtitle {
                font-size: 0.85em;
            }
            .content {
                padding: 15px 8px;
            }
            .question {
                padding: 12px;
            }
            .question h3 {
                font-size: 1em;
            }
            .option {
                padding: 10px 8px;
                font-size: 0.9em;
            }
            .submit-btn {
                padding: 12px 15px;
                font-size: 1em;
            }
            .results {
                padding: 15px;
            }
            .results h2 {
                font-size: 1.3em;
            }
            .result-item {
                padding: 10px;
            }
            .result-item h3 {
                font-size: 1em;
            }
            .bar {
                font-size: 0.75em;
            }
            .tag {
                padding: 4px 8px;
                font-size: 0.75em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>人格与星座综合测试</h1>
            <p class="subtitle">基于40个性格标签的深度人格分析</p>
        </header>
        <div class="content">
            <!-- 第一页：性格测试 -->
            <div id="test-page" class="page active">
                <div class="progress">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
                <div class="form-group">
                    <label for="dob">请输入你的出生日期：</label>
                    <input type="date" id="dob" class="date-input" required>
                </div>
                <div id="questions-container">
                    <!-- 40道问题将通过JavaScript动态生成 -->
                </div>
                <div class="btn-group">
                    <button type="button" id="nextToPostTestBtn" class="submit-btn">进入下一步</button>
                </div>
            </div>
            <!-- 第二页：后天与行为标签 -->
            <div id="post-test-page" class="page">
                <div class="post-test-header">
                    <h2>完善你的个人画像</h2>
                    <p>请选择以下标签，让分析更精准</p>
                </div>
                <div class="tag-section">
                    <h2 class="section-title"><i>🔄</i> 后天标签（动态雕刻）</h2>
                    <div class="tag-group">
                        <h3><i>🧠</i> MBTI</h3>
                        <div class="tag-options" id="mbti-options">
                            <div class="tag-option" data-tag="INTJ">INTJ</div>
                            <div class="tag-option" data-tag="INTP">INTP</div>
                            <div class="tag-option" data-tag="ENTJ">ENTJ</div>
                            <div class="tag-option" data-tag="ENTP">ENTP</div>
                            <div class="tag-option" data-tag="INFJ">INFJ</div>
                            <div class="tag-option" data-tag="INFP">INFP</div>
                            <div class="tag-option" data-tag="ENFJ">ENFJ</div>
                            <div class="tag-option" data-tag="ENFP">ENFP</div>
                            <div class="tag-option" data-tag="ISTJ">ISTJ</div>
                            <div class="tag-option" data-tag="ISFJ">ISFJ</div>
                            <div class="tag-option" data-tag="ESTJ">ESTJ</div>
                            <div class="tag-option" data-tag="ESFJ">ESFJ</div>
                            <div class="tag-option" data-tag="ISTP">ISTP</div>
                            <div class="tag-option" data-tag="ISFP">ISFP</div>
                            <div class="tag-option" data-tag="ESTP">ESTP</div>
                            <div class="tag-option" data-tag="ESFP">ESFP</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>💉</i> 血型</h3>
                        <div class="tag-options" id="blood-options">
                            <div class="tag-option" data-tag="A型">A型</div>
                            <div class="tag-option" data-tag="B型">B型</div>
                            <div class="tag-option" data-tag="O型">O型</div>
                            <div class="tag-option" data-tag="AB型">AB型</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>⚡</i> 关键事件</h3>
                        <div class="tag-options" id="event-options">
                            <div class="tag-option" data-tag="重大失败">重大失败</div>
                            <div class="tag-option" data-tag="突遇贵人">突遇贵人</div>
                            <div class="tag-option" data-tag="移民经历">移民经历</div>
                            <div class="tag-option" data-tag="自然灾害">自然灾害</div>
                            <div class="tag-option" data-tag="重大疾病">重大疾病</div>
                            <div class="tag-option" data-tag="意外财富">意外财富</div>
                            <div class="tag-option" data-tag="创业成功">创业成功</div>
                            <div class="tag-option" data-tag="家庭变故">家庭变故</div>
                            <div class="tag-option" data-tag="教育转折">教育转折</div>
                            <div class="tag-option" data-tag="长期异地">长期异地</div>
                            <div class="tag-option" data-tag="法律纠纷">法律纠纷</div>
                            <div class="tag-option" data-tag="艺术启蒙">艺术启蒙</div>
                            <div class="tag-option" data-tag="宗教体验">宗教体验</div>
                            <div class="tag-option" data-tag="军事服役">军事服役</div>
                            <div class="tag-option" data-tag="网络走红">网络走红</div>
                            <div class="tag-option" data-tag="学术突破">学术突破</div>
                            <div class="tag-option" data-tag="职业转型">职业转型</div>
                            <div class="tag-option" data-tag="文化冲击">文化冲击</div>
                            <div class="tag-option" data-tag="重大获奖">重大获奖</div>
                            <div class="tag-option" data-tag="创伤经历">创伤经历</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>💼</i> 职业烙印</h3>
                        <div class="tag-options" id="career-options">
                            <div class="tag-option" data-tag="程序员">程序员</div>
                            <div class="tag-option" data-tag="销售">销售</div>
                            <div class="tag-option" data-tag="艺术家">艺术家</div>
                            <div class="tag-option" data-tag="医生">医生</div>
                            <div class="tag-option" data-tag="教师">教师</div>
                            <div class="tag-option" data-tag="军人">军人</div>
                            <div class="tag-option" data-tag="企业家">企业家</div>
                            <div class="tag-option" data-tag="自由职业">自由职业</div>
                            <div class="tag-option" data-tag="设计师">设计师</div>
                            <div class="tag-option" data-tag="记者">记者</div>
                            <div class="tag-option" data-tag="金融分析师">金融分析师</div>
                            <div class="tag-option" data-tag="科研人员">科研人员</div>
                            <div class="tag-option" data-tag="公务员">公务员</div>
                            <div class="tag-option" data-tag="工程师">工程师</div>
                            <div class="tag-option" data-tag="演员">演员</div>
                            <div class="tag-option" data-tag="心理咨询师">心理咨询师</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>🏛️</i> 社会阶层</h3>
                        <div class="tag-options" id="class-options">
                            <div class="tag-option" data-tag="寒门出身">寒门出身</div>
                            <div class="tag-option" data-tag="中产家庭">中产家庭</div>
                            <div class="tag-option" data-tag="富裕阶层">富裕阶层</div>
                            <div class="tag-option" data-tag="新贵家庭">新贵家庭</div>
                            <div class="tag-option" data-tag="知识精英">知识精英</div>
                            <div class="tag-option" data-tag="工薪阶层">工薪阶层</div>
                            <div class="tag-option" data-tag="艺术世家">艺术世家</div>
                            <div class="tag-option" data-tag="官宦背景">官宦背景</div>
                        </div>
                    </div>
                </div>
                <div class="tag-section">
                    <h2 class="section-title"><i>👣</i> 行为标签（显性表达）</h2>
                    <div class="tag-group">
                        <h3><i>🛒</i> 消费印记</h3>
                        <div class="tag-options" id="spend-options">
                            <div class="tag-option" data-tag="奢侈品">奢侈品</div>
                            <div class="tag-option" data-tag="知识付费">知识付费</div>
                            <div class="tag-option" data-tag="极简主义">极简主义</div>
                            <div class="tag-option" data-tag="冲动消费">冲动消费</div>
                            <div class="tag-option" data-tag="收藏癖好">收藏癖好</div>
                            <div class="tag-option" data-tag="体验至上">体验至上</div>
                            <div class="tag-option" data-tag="性价比控">性价比控</div>
                            <div class="tag-option" data-tag="品牌忠诚">品牌忠诚</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>👥</i> 社交指纹</h3>
                        <div class="tag-options" id="social-options">
                            <div class="tag-option" data-tag="群聊主导者">群聊主导者</div>
                            <div class="tag-option" data-tag="倾听者">倾听者</div>
                            <div class="tag-option" data-tag="段子手">段子手</div>
                            <div class="tag-option" data-tag="社交回避">社交回避</div>
                            <div class="tag-option" data-tag="关系协调者">关系协调者</div>
                            <div class="tag-option" data-tag="意见领袖">意见领袖</div>
                            <div class="tag-option" data-tag="搭讪达人">搭讪达人</div>
                            <div class="tag-option" data-tag="聚会策划">聚会策划</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>⏱️</i> 时间分配</h3>
                        <div class="tag-options" id="time-options">
                            <div class="tag-option" data-tag="夜间活跃">夜间活跃</div>
                            <div class="tag-option" data-tag="晨型人">晨型人</div>
                            <div class="tag-option" data-tag="碎片化">碎片化</div>
                            <div class="tag-option" data-tag="深度工作">深度工作</div>
                            <div class="tag-option" data-tag="多任务处理">多任务处理</div>
                            <div class="tag-option" data-tag="拖延大师">拖延大师</div>
                            <div class="tag-option" data-tag="严格日程">严格日程</div>
                            <div class="tag-option" data-tag="即兴生活">即兴生活</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>📱</i> 数字肢体语言</h3>
                        <div class="tag-options" id="digital-options">
                            <div class="tag-option" data-tag="点赞狂魔">点赞狂魔</div>
                            <div class="tag-option" data-tag="已读不回">已读不回</div>
                            <div class="tag-option" data-tag="长文党">长文党</div>
                            <div class="tag-option" data-tag="表情包达人">表情包达人</div>
                            <div class="tag-option" data-tag="深夜发图">深夜发图</div>
                            <div class="tag-option" data-tag="头像常换">头像常换</div>
                            <div class="tag-option" data-tag="签名更新">签名更新</div>
                            <div class="tag-option" data-tag="群内潜水">群内潜水</div>
                        </div>
                    </div>
                </div>
                <div class="btn-group">
                    <button type="button" id="backToTestBtn" class="submit-btn back-btn">上一步</button>
                    <button type="button" id="submitFinalBtn" class="submit-btn">生成我的人格报告</button>
                </div>
            </div>
            <!-- 第三页：结果页 -->
            <div id="results-page" class="page">
                <div id="results-content">
                    <!-- 结果将通过JavaScript动态生成 -->
                </div>
            </div>
        </div>
    </div>
    <script>
        // 四液质标签和评分规则
        const temperamentTags = [
            { label: "社交", openness: 6, conscientiousness: 4, extraversion: 9, agreeableness: 7, neuroticism: 3 },
            { label: "活泼", openness: 6, conscientiousness: 3, extraversion: 9, agreeableness: 6, neuroticism: 3 },
            { label: "情绪波动", openness: 5, conscientiousness: 2, extraversion: 7, agreeableness: 5, neuroticism: 8 },
            { label: "精力旺盛", openness: 5, conscientiousness: 5, extraversion: 9, agreeableness: 5, neuroticism: 3 },
            { label: "乐观", openness: 7, conscientiousness: 4, extraversion: 8, agreeableness: 7, neuroticism: 2 },
            { label: "健谈", openness: 5, conscientiousness: 3, extraversion: 9, agreeableness: 6, neuroticism: 4 },
            { label: "随和", openness: 5, conscientiousness: 4, extraversion: 7, agreeableness: 8, neuroticism: 3 },
            { label: "寻求刺激", openness: 8, conscientiousness: 3, extraversion: 8, agreeableness: 5, neuroticism: 5 },
            { label: "果断", openness: 5, conscientiousness: 8, extraversion: 8, agreeableness: 4, neuroticism: 5 },
            { label: "领导力", openness: 6, conscientiousness: 8, extraversion: 9, agreeableness: 5, neuroticism: 4 },
            { label: "野心", openness: 7, conscientiousness: 9, extraversion: 8, agreeableness: 3, neuroticism: 6 },
            { label: "自信", openness: 6, conscientiousness: 6, extraversion: 8, agreeableness: 5, neuroticism: 3 },
            { label: "竞争性", openness: 5, conscientiousness: 7, extraversion: 8, agreeableness: 3, neuroticism: 6 },
            { label: "目标导向", openness: 5, conscientiousness: 9, extraversion: 7, agreeableness: 4, neuroticism: 4 },
            { label: "急躁", openness: 4, conscientiousness: 5, extraversion: 7, agreeableness: 3, neuroticism: 7 },
            { label: "支配性", openness: 5, conscientiousness: 7, extraversion: 8, agreeableness: 2, neuroticism: 6 },
            { label: "敏感", openness: 7, conscientiousness: 6, extraversion: 2, agreeableness: 7, neuroticism: 9 },
            { label: "温柔", openness: 5, conscientiousness: 5, extraversion: 3, agreeableness: 9, neuroticism: 6 },
            { label: "封闭", openness: 6, conscientiousness: 5, extraversion: 1, agreeableness: 5, neuroticism: 7 },
            { label: "共情", openness: 7, conscientiousness: 5, extraversion: 3, agreeableness: 9, neuroticism: 6 },
            { label: "完美主义", openness: 6, conscientiousness: 9, extraversion: 3, agreeableness: 6, neuroticism: 8 },
            { label: "深思熟虑", openness: 8, conscientiousness: 8, extraversion: 2, agreeableness: 6, neuroticism: 5 },
            { label: "悲观", openness: 5, conscientiousness: 6, extraversion: 2, agreeableness: 7, neuroticism: 9 },
            { label: "理想主义", openness: 9, conscientiousness: 5, extraversion: 3, agreeableness: 7, neuroticism: 7 },
            { label: "冷静", openness: 4, conscientiousness: 7, extraversion: 4, agreeableness: 8, neuroticism: 2 },
            { label: "耐心", openness: 4, conscientiousness: 8, extraversion: 3, agreeableness: 9, neuroticism: 3 },
            { label: "稳定", openness: 3, conscientiousness: 8, extraversion: 4, agreeableness: 8, neuroticism: 2 },
            { label: "可靠", openness: 3, conscientiousness: 9, extraversion: 3, agreeableness: 8, neuroticism: 2 },
            { label: "平和", openness: 4, conscientiousness: 6, extraversion: 4, agreeableness: 9, neuroticism: 1 },
            { label: "规律", openness: 2, conscientiousness: 8, extraversion: 4, agreeableness: 6, neuroticism: 3 },
            { label: "避免冲突", openness: 3, conscientiousness: 5, extraversion: 3, agreeableness: 9, neuroticism: 4 },
            { label: "务实", openness: 4, conscientiousness: 8, extraversion: 4, agreeableness: 6, neuroticism: 3 },
            { label: "物质主导", openness: 1, conscientiousness: 7, extraversion: 4, agreeableness: 5, neuroticism: 3 },
            { label: "被动", openness: 3, conscientiousness: 2, extraversion: 2, agreeableness: 6, neuroticism: 3 },
            { label: "内敛", openness: 4, conscientiousness: 5, extraversion: 2, agreeableness: 7, neuroticism: 4 },
            { label: "非黑即白", openness: 2, conscientiousness: 7, extraversion: 6, agreeableness: 3, neuroticism: 5 }
        ];
        // 星座标签
        const zodiacTags = {
            "白羊座": ["开拓者", "行动派", "竞争者", "急先锋", "无畏者"],
            "金牛座": ["守护者", "享乐家", "固执者", "品味家", "稳定器"],
            "双子座": ["沟通者", "好奇宝宝", "信息贩子", "多面手", "机智派"],
            "巨蟹座": ["保护者", "怀旧者", "情绪海绵", "家庭主厨", "安全感寻求者"],
            "狮子座": ["表演者", "慷慨者", "自恋者", "领袖", "聚光灯爱好者"],
            "处女座": ["完美主义者", "分析师", "细节控", "服务者", "洁癖"],
            "天秤座": ["平衡者", "优雅者", "犹豫者", "调解人", "美学爱好者"],
            "天蝎座": ["探索者", "神秘者", "洞察者", "激情者", "复仇者"],
            "射手座": ["冒险家", "哲学家", "自由者", "乐观者", "旅行者"],
            "摩羯座": ["攀登者", "现实者", "责任者", "保守派", "成就导向者"],
            "水瓶座": ["革新者", "人道主义者", "怪人", "未来主义者", "社交观察者"],
            "双鱼座": ["梦想家", "共情者", "逃避者", "艺术家", "救世主情结"]
        };
        // 五行属性
        const zodiacElementMap = {
            "白羊座": "火", "狮子座": "火", "射手座": "火",
            "金牛座": "土", "处女座": "土", "摩羯座": "土",
            "双子座": "风", "天秤座": "风", "水瓶座": "风",
            "巨蟹座": "水", "天蝎座": "水", "双鱼座": "水"
        };
        // 大五人格特殊机制
        const bigFiveMechanisms = {
            "白羊座": {
                traits: [
                    { trait: "开放性", high: "冒险催化剂", low: "常规依赖者", correction: "新挑战→开放性+35%" },
                    { trait: "尽责性", high: "行动型尽责", low: "计划蒸发者", correction: "紧迫感→尽责性+50%" },
                    { trait: "外向性", high: "能量辐射体", low: "独行侠", correction: "竞争场景→外向性异常高涨" },
                    { trait: "宜人性", high: "直率型友善", low: "攻击性表达", correction: "被误解→宜人性-20%" },
                    { trait: "神经质", high: "冲动接收器", low: "无畏镇定剂", correction: "挫败感→神经质+40%" }
                ],
                special: "当「冒险催化剂」与「能量辐射体」同时激活 → 触发「冲锋模式」"
            },
            "天蝎座": {
                traits: [
                    { trait: "开放性", high: "幻象酿酒师", low: "现实锚定者", correction: "深夜独处→开放性+45%" },
                    { trait: "尽责性", high: "情绪型尽责", low: "承诺蒸发者", correction: "恋人期待→尽责性+60%" },
                    { trait: "外向性", high: "共情海绵体", low: "能量枯竭者", correction: "受害者叙事→外向性异常高涨" },
                    { trait: "宜人性", high: "边界溶解者", low: "自我献祭癖", correction: "被求助→宜人性突破阈值" },
                    { trait: "神经质", high: "全频段接收器", low: "艺术镇定剂", correction: "阴雨天→神经质+30%" }
                ],
                special: "当「幻象酿酒师」与「艺术镇定剂」同时激活 → 产生高价值创造性作品"
            }
        };
        // 后天标签的大五人格评分规则
        const postTagScores = {
            mbti: {
                "INTJ": { openness: 7, conscientiousness: 9, extraversion: 3, agreeableness: 5, neuroticism: 6 },
                "INTP": { openness: 8, conscientiousness: 7, extraversion: 4, agreeableness: 5, neuroticism: 5 },
                "ENTJ": { openness: 7, conscientiousness: 9, extraversion: 8, agreeableness: 4, neuroticism: 5 },
                "ENTP": { openness: 9, conscientiousness: 7, extraversion: 8, agreeableness: 5, neuroticism: 6 },
                "INFJ": { openness: 7, conscientiousness: 8, extraversion: 3, agreeableness: 8, neuroticism: 7 },
                "INFP": { openness: 8, conscientiousness: 6, extraversion: 3, agreeableness: 9, neuroticism: 8 },
                "ENFJ": { openness: 7, conscientiousness: 8, extraversion: 8, agreeableness: 9, neuroticism: 5 },
                "ENFP": { openness: 9, conscientiousness: 6, extraversion: 8, agreeableness: 8, neuroticism: 7 },
                "ISTJ": { openness: 5, conscientiousness: 9, extraversion: 3, agreeableness: 6, neuroticism: 3 },
                "ISFJ": { openness: 5, conscientiousness: 9, extraversion: 4, agreeableness: 9, neuroticism: 4 },
                "ESTJ": { openness: 5, conscientiousness: 9, extraversion: 7, agreeableness: 6, neuroticism: 3 },
                "ESFJ": { openness: 5, conscientiousness: 8, extraversion: 8, agreeableness: 9, neuroticism: 4 },
                "ISTP": { openness: 7, conscientiousness: 8, extraversion: 5, agreeableness: 6, neuroticism: 5 },
                "ISFP": { openness: 7, conscientiousness: 6, extraversion: 4, agreeableness: 9, neuroticism: 6 },
                "ESTP": { openness: 7, conscientiousness: 7, extraversion: 8, agreeableness: 6, neuroticism: 6 },
                "ESFP": { openness: 7, conscientiousness: 6, extraversion: 8, agreeableness: 8, neuroticism: 5 }
            },
            blood: {
                "A型": { openness: 4, conscientiousness: 8, extraversion: 4, agreeableness: 6, neuroticism: 4 },
                "B型": { openness: 7, conscientiousness: 5, extraversion: 7, agreeableness: 5, neuroticism: 6 },
                "O型": { openness: 5, conscientiousness: 7, extraversion: 7, agreeableness: 5, neuroticism: 3 },
                "AB型": { openness: 6, conscientiousness: 6, extraversion: 5, agreeableness: 6, neuroticism: 7 }
            },
            event: {
                "重大失败": { openness: 6, conscientiousness: 5, extraversion: 5, agreeableness: 6, neuroticism: 8 },
                "突遇贵人": { openness: 7, conscientiousness: 7, extraversion: 8, agreeableness: 8, neuroticism: 4 },
                "移民经历": { openness: 8, conscientiousness: 6, extraversion: 6, agreeableness: 6, neuroticism: 7 },
                "自然灾害": { openness: 5, conscientiousness: 6, extraversion: 5, agreeableness: 7, neuroticism: 8 },
                "重大疾病": { openness: 6, conscientiousness: 5, extraversion: 4, agreeableness: 8, neuroticism: 9 },
                "意外财富": { openness: 7, conscientiousness: 5, extraversion: 8, agreeableness: 5, neuroticism: 5 },
                "创业成功": { openness: 7, conscientiousness: 8, extraversion: 8, agreeableness: 4, neuroticism: 6 },
                "家庭变故": { openness: 5, conscientiousness: 5, extraversion: 4, agreeableness: 8, neuroticism: 9 },
                "教育转折": { openness: 8, conscientiousness: 7, extraversion: 5, agreeableness: 6, neuroticism: 5 },
                "长期异地": { openness: 7, conscientiousness: 5, extraversion: 6, agreeableness: 7, neuroticism: 7 },
                "法律纠纷": { openness: 5, conscientiousness: 7, extraversion: 5, agreeableness: 4, neuroticism: 8 },
                "艺术启蒙": { openness: 9, conscientiousness: 5, extraversion: 6, agreeableness: 7, neuroticism: 6 },
                "宗教体验": { openness: 9, conscientiousness: 6, extraversion: 4, agreeableness: 8, neuroticism: 7 },
                "军事服役": { openness: 4, conscientiousness: 9, extraversion: 7, agreeableness: 5, neuroticism: 4 },
                "网络走红": { openness: 8, conscientiousness: 5, extraversion: 9, agreeableness: 5, neuroticism: 7 },
                "学术突破": { openness: 9, conscientiousness: 9, extraversion: 4, agreeableness: 5, neuroticism: 4 },
                "职业转型": { openness: 8, conscientiousness: 7, extraversion: 7, agreeableness: 6, neuroticism: 6 },
                "文化冲击": { openness: 9, conscientiousness: 6, extraversion: 6, agreeableness: 6, neuroticism: 7 },
                "重大获奖": { openness: 7, conscientiousness: 8, extraversion: 8, agreeableness: 5, neuroticism: 3 },
                "创伤经历": { openness: 6, conscientiousness: 4, extraversion: 4, agreeableness: 7, neuroticism: 9 }
            },
            career: {
                "程序员": { openness: 6, conscientiousness: 9, extraversion: 4, agreeableness: 5, neuroticism: 4 },
                "销售": { openness: 6, conscientiousness: 7, extraversion: 9, agreeableness: 6, neuroticism: 6 },
                "艺术家": { openness: 9, conscientiousness: 5, extraversion: 6, agreeableness: 7, neuroticism: 7 },
                "医生": { openness: 6, conscientiousness: 9, extraversion: 5, agreeableness: 9, neuroticism: 5 },
                "教师": { openness: 6, conscientiousness: 8, extraversion: 7, agreeableness: 9, neuroticism: 4 },
                "军人": { openness: 4, conscientiousness: 9, extraversion: 7, agreeableness: 5, neuroticism: 3 },
                "企业家": { openness: 8, conscientiousness: 9, extraversion: 8, agreeableness: 4, neuroticism: 7 },
                "自由职业": { openness: 8, conscientiousness: 6, extraversion: 7, agreeableness: 6, neuroticism: 6 },
                "设计师": { openness: 9, conscientiousness: 7, extraversion: 6, agreeableness: 7, neuroticism: 6 },
                "记者": { openness: 8, conscientiousness: 7, extraversion: 8, agreeableness: 6, neuroticism: 6 },
                "金融分析师": { openness: 5, conscientiousness: 9, extraversion: 5, agreeableness: 5, neuroticism: 5 },
                "科研人员": { openness: 9, conscientiousness: 9, extraversion: 4, agreeableness: 6, neuroticism: 4 },
                "公务员": { openness: 4, conscientiousness: 9, extraversion: 4, agreeableness: 8, neuroticism: 3 },
                "工程师": { openness: 6, conscientiousness: 9, extraversion: 5, agreeableness: 6, neuroticism: 4 },
                "演员": { openness: 8, conscientiousness: 5, extraversion: 8, agreeableness: 7, neuroticism: 8 },
                "心理咨询师": { openness: 8, conscientiousness: 7, extraversion: 5, agreeableness: 9, neuroticism: 7 }
            },
            class: {
                "寒门出身": { openness: 6, conscientiousness: 7, extraversion: 6, agreeableness: 6, neuroticism: 8 },
                "中产家庭": { openness: 6, conscientiousness: 7, extraversion: 6, agreeableness: 7, neuroticism: 5 },
                "富裕阶层": { openness: 6, conscientiousness: 6, extraversion: 7, agreeableness: 6, neuroticism: 4 },
                "新贵家庭": { openness: 7, conscientiousness: 7, extraversion: 7, agreeableness: 6, neuroticism: 5 },
                "知识精英": { openness: 8, conscientiousness: 8, extraversion: 5, agreeableness: 7, neuroticism: 4 },
                "工薪阶层": { openness: 5, conscientiousness: 7, extraversion: 5, agreeableness: 7, neuroticism: 5 },
                "艺术世家": { openness: 9, conscientiousness: 6, extraversion: 6, agreeableness: 8, neuroticism: 6 },
                "官宦背景": { openness: 5, conscientiousness: 8, extraversion: 7, agreeableness: 5, neuroticism: 4 }
            },
            spend: {
                "奢侈品": { openness: 7, conscientiousness: 5, extraversion: 8, agreeableness: 5, neuroticism: 5 },
                "知识付费": { openness: 8, conscientiousness: 8, extraversion: 5, agreeableness: 6, neuroticism: 4 },
                "极简主义": { openness: 6, conscientiousness: 9, extraversion: 4, agreeableness: 7, neuroticism: 3 },
                "冲动消费": { openness: 7, conscientiousness: 4, extraversion: 8, agreeableness: 5, neuroticism: 8 },
                "收藏癖好": { openness: 8, conscientiousness: 7, extraversion: 5, agreeableness: 6, neuroticism: 6 },
                "体验至上": { openness: 8, conscientiousness: 6, extraversion: 8, agreeableness: 7, neuroticism: 5 },
                "性价比控": { openness: 5, conscientiousness: 9, extraversion: 4, agreeableness: 7, neuroticism: 3 },
                "品牌忠诚": { openness: 5, conscientiousness: 8, extraversion: 5, agreeableness: 8, neuroticism: 4 }
            },
            social: {
                "群聊主导者": { openness: 6, conscientiousness: 5, extraversion: 9, agreeableness: 6, neuroticism: 5 },
                "倾听者": { openness: 6, conscientiousness: 6, extraversion: 4, agreeableness: 9, neuroticism: 4 },
                "段子手": { openness: 8, conscientiousness: 5, extraversion: 9, agreeableness: 6, neuroticism: 6 },
                "社交回避": { openness: 6, conscientiousness: 5, extraversion: 2, agreeableness: 7, neuroticism: 7 },
                "关系协调者": { openness: 6, conscientiousness: 8, extraversion: 8, agreeableness: 9, neuroticism: 4 },
                "意见领袖": { openness: 7, conscientiousness: 7, extraversion: 9, agreeableness: 5, neuroticism: 5 },
                "搭讪达人": { openness: 7, conscientiousness: 5, extraversion: 9, agreeableness: 5, neuroticism: 6 },
                "聚会策划": { openness: 7, conscientiousness: 8, extraversion: 9, agreeableness: 8, neuroticism: 4 }
            },
            time: {
                "夜间活跃": { openness: 7, conscientiousness: 5, extraversion: 7, agreeableness: 5, neuroticism: 8 },
                "晨型人": { openness: 5, conscientiousness: 8, extraversion: 6, agreeableness: 6, neuroticism: 3 },
                "碎片化": { openness: 6, conscientiousness: 4, extraversion: 7, agreeableness: 6, neuroticism: 7 },
                "深度工作": { openness: 7, conscientiousness: 9, extraversion: 4, agreeableness: 5, neuroticism: 4 },
                "多任务处理": { openness: 7, conscientiousness: 7, extraversion: 8, agreeableness: 5, neuroticism: 6 },
                "拖延大师": { openness: 6, conscientiousness: 3, extraversion: 7, agreeableness: 6, neuroticism: 8 },
                "严格日程": { openness: 5, conscientiousness: 9, extraversion: 5, agreeableness: 6, neuroticism: 3 },
                "即兴生活": { openness: 8, conscientiousness: 4, extraversion: 8, agreeableness: 6, neuroticism: 7 }
            },
            digital: {
                "点赞狂魔": { openness: 6, conscientiousness: 4, extraversion: 8, agreeableness: 7, neuroticism: 5 },
                "已读不回": { openness: 6, conscientiousness: 5, extraversion: 5, agreeableness: 4, neuroticism: 7 },
                "长文党": { openness: 8, conscientiousness: 7, extraversion: 4, agreeableness: 6, neuroticism: 5 },
                "表情包达人": { openness: 8, conscientiousness: 5, extraversion: 8, agreeableness: 7, neuroticism: 6 },
                "深夜发图": { openness: 7, conscientiousness: 4, extraversion: 7, agreeableness: 5, neuroticism: 8 },
                "头像常换": { openness: 7, conscientiousness: 4, extraversion: 7, agreeableness: 6, neuroticism: 7 },
                "签名更新": { openness: 7, conscientiousness: 5, extraversion: 6, agreeableness: 6, neuroticism: 7 },
                "群内潜水": { openness: 5, conscientiousness: 5, extraversion: 3, agreeableness: 7, neuroticism: 5 }
            }
        };
        // 用于存储用户选择的后天和行为标签
        const userPostTags = {
            mbti: [],
            blood: [],
            event: [],
            career: [],
            class: [],
            spend: [],
            social: [],
            time: [],
            digital: []
        };
        // 页面加载完成后生成问题
        document.addEventListener('DOMContentLoaded', function() {
            const questionsContainer = document.getElementById('questions-container');
            const progressBar = document.getElementById('progress-bar');
            const testPage = document.getElementById('test-page');
            const postTestPage = document.getElementById('post-test-page');
            const resultsPage = document.getElementById('results-page');
            // 生成40道问题
            for (let i = 0; i < 40; i++) {
                const question = temperamentTags[i % temperamentTags.length]; // 循环使用标签
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <h3>第${i + 1}/40题</h3>
                    <p style="margin-bottom: 12px; color: #555; line-height: 1.4;">我是一个${question.label}的人？</p>
                    <div class="options" id="options-${i}">
                        <div class="option" data-value="yes" data-question="${i}">是</div>
                        <div class="option" data-value="no" data-question="${i}">否</div>
                    </div>
                `;
                questionsContainer.appendChild(questionDiv);
            }
            // 为所有选项添加点击事件
            const optionElements = document.querySelectorAll('.option');
            optionElements.forEach(option => {
                option.addEventListener('click', function() {
                    const value = this.getAttribute('data-value');
                    const questionIndex = this.getAttribute('data-question');
                    // 更新UI
                    const options = this.parentElement.querySelectorAll('.option');
                    options.forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    // 更新进度条
                    updateProgress();
                });
            });
            // 更新进度条
            function updateProgress() {
                const totalQuestions = 40;
                const answeredQuestions = document.querySelectorAll('.option.selected').length;
                const progressPercent = (answeredQuestions / totalQuestions) * 100;
                progressBar.style.width = progressPercent + '%';
            }
            // 获取星座
            function getZodiac(dob) {
                const month = dob.getMonth() + 1;
                const day = dob.getDate();
                let sign = '';
                if ((month === 3 && day >= 21) || (month === 4 && day <= 19)) sign = "白羊座";
                else if ((month === 4 && day >= 20) || (month === 5 && day <= 20)) sign = "金牛座";
                else if ((month === 5 && day >= 21) || (month === 6 && day <= 20)) sign = "双子座";
                else if ((month === 6 && day >= 21) || (month === 7 && day <= 22)) sign = "巨蟹座";
                else if ((month === 7 && day >= 23) || (month === 8 && day <= 22)) sign = "狮子座";
                else if ((month === 8 && day >= 23) || (month === 9 && day <= 22)) sign = "处女座";
                else if ((month === 9 && day >= 23) || (month === 10 && day <= 22)) sign = "天秤座";
                else if ((month === 10 && day >= 23) || (month === 11 && day <= 21)) sign = "天蝎座";
                else if ((month === 11 && day >= 22) || (month === 12 && day <= 21)) sign = "射手座";
                else if ((month === 12 && day >= 22) || (month === 1 && day <= 19)) sign = "摩羯座";
                else if ((month === 1 && day >= 20) || (month === 2 && day <= 18)) sign = "水瓶座";
                else if ((month === 2 && day >= 19) || (month === 3 && day <= 20)) sign = "双鱼座";
                return sign;
            }
            // 计算四液质结果
            function getTemperamentResult() {
                const scores = { sanguine: 0, choleric: 0, melancholic: 0, phlegmatic: 0 };
                const bigFiveScores = { openness: 0, conscientiousness: 0, extraversion: 0, agreeableness: 0, neuroticism: 0 };
                for (let i = 0; i < 40; i++) {
                    const selectedValue = document.querySelector(`#options-${i} .option.selected`)?.getAttribute('data-value');
                    if (selectedValue === 'yes') {
                        const tag = temperamentTags[i % temperamentTags.length];
                        // 四液质计分
                        if (temperamentTags[i % temperamentTags.length].label === "社交" || temperamentTags[i % temperamentTags.length].label === "活泼" || 
                            temperamentTags[i % temperamentTags.length].label === "情绪波动" || temperamentTags[i % temperamentTags.length].label === "精力旺盛" ||
                            temperamentTags[i % temperamentTags.length].label === "乐观" || temperamentTags[i % temperamentTags.length].label === "健谈" ||
                            temperamentTags[i % temperamentTags.length].label === "随和" || temperamentTags[i % temperamentTags.length].label === "寻求刺激") {
                            scores.sanguine += 1;
                        } else if (temperamentTags[i % temperamentTags.length].label === "果断" || temperamentTags[i % temperamentTags.length].label === "领导力" || 
                                  temperamentTags[i % temperamentTags.length].label === "野心" || temperamentTags[i % temperamentTags.length].label === "自信" ||
                                  temperamentTags[i % temperamentTags.length].label === "竞争性" || temperamentTags[i % temperamentTags.length].label === "目标导向" ||
                                  temperamentTags[i % temperamentTags.length].label === "急躁" || temperamentTags[i % temperamentTags.length].label === "支配性") {
                            scores.choleric += 1;
                        } else if (temperamentTags[i % temperamentTags.length].label === "敏感" || temperamentTags[i % temperamentTags.length].label === "温柔" || 
                                   temperamentTags[i % temperamentTags.length].label === "封闭" || temperamentTags[i % temperamentTags.length].label === "共情" ||
                                   temperamentTags[i % temperamentTags.length].label === "完美主义" || temperamentTags[i % temperamentTags.length].label === "深思熟虑" ||
                                   temperamentTags[i % temperamentTags.length].label === "悲观" || temperamentTags[i % temperamentTags.length].label === "理想主义") {
                            scores.melancholic += 1;
                        } else {
                            scores.phlegmatic += 1;
                        }
                        // 大五人格计分
                        bigFiveScores.openness += tag.openness;
                        bigFiveScores.conscientiousness += tag.conscientiousness;
                        bigFiveScores.extraversion += tag.extraversion;
                        bigFiveScores.agreeableness += tag.agreeableness;
                        bigFiveScores.neuroticism += tag.neuroticism;
                    }
                }
                // 将大五人格分数标准化到0-100范围
                const maxPossible = 40 * 9; // 40题 * 最高分9
                const minPossible = 0;
                const range = maxPossible - minPossible;
                const normalizedBigFive = {
                    openness: Math.round((bigFiveScores.openness / range) * 100),
                    conscientiousness: Math.round((bigFiveScores.conscientiousness / range) * 100),
                    extraversion: Math.round((bigFiveScores.extraversion / range) * 100),
                    agreeableness: Math.round((bigFiveScores.agreeableness / range) * 100),
                    neuroticism: Math.round((bigFiveScores.neuroticism / range) * 100)
                };
                return {
                    temperamentScores: scores,
                    bigFiveScores: normalizedBigFive
                };
            }
            // 计算后天大五人格得分
            function getPostBigFiveScores() {
                const scores = { openness: 0, conscientiousness: 0, extraversion: 0, agreeableness: 0, neuroticism: 0 };
                let tagCount = 0;
                
                // 遍历所有标签类型
                Object.keys(userPostTags).forEach(tagType => {
                    userPostTags[tagType].forEach(tag => {
                        if (postTagScores[tagType] && postTagScores[tagType][tag]) {
                            scores.openness += postTagScores[tagType][tag].openness;
                            scores.conscientiousness += postTagScores[tagType][tag].conscientiousness;
                            scores.extraversion += postTagScores[tagType][tag].extraversion;
                            scores.agreeableness += postTagScores[tagType][tag].agreeableness;
                            scores.neuroticism += postTagScores[tagType][tag].neuroticism;
                            tagCount++;
                        }
                    });
                });
                
                // 如果没有选择任何标签，返回默认值
                if (tagCount === 0) {
                    return {
                        openness: 50,
                        conscientiousness: 50,
                        extraversion: 50,
                        agreeableness: 50,
                        neuroticism: 50
                    };
                }
                
                // 计算平均值并标准化到0-100范围
                const avgOpenness = (scores.openness / tagCount) * (100 / 9);
                const avgConscientiousness = (scores.conscientiousness / tagCount) * (100 / 9);
                const avgExtraversion = (scores.extraversion / tagCount) * (100 / 9);
                const avgAgreeableness = (scores.agreeableness / tagCount) * (100 / 9);
                const avgNeuroticism = (scores.neuroticism / tagCount) * (100 / 9);
                
                return {
                    openness: Math.round(avgOpenness),
                    conscientiousness: Math.round(avgConscientiousness),
                    extraversion: Math.round(avgExtraversion),
                    agreeableness: Math.round(avgAgreeableness),
                    neuroticism: Math.round(avgNeuroticism)
                };
            }
            // 为所有可选项添加点击事件
            document.querySelectorAll('.tag-options').forEach(group => {
                const groupId = group.id;
                const options = group.querySelectorAll('.tag-option');
                options.forEach(option => {
                    option.addEventListener('click', function() {
                        const tag = this.getAttribute('data-tag');
                        const isSingleSelect = ['mbti', 'blood'].some(prefix => groupId.startsWith(prefix));
                        if (isSingleSelect) {
                            // 单选逻辑 (MBTI, 血型)
                            options.forEach(opt => opt.classList.remove('selected', 'single-selected'));
                            this.classList.add('single-selected');
                            // 清空数组并添加新选择
                            userPostTags[groupId.replace('-options', '')] = [tag];
                        } else {
                            // 多选逻辑
                            this.classList.toggle('selected');
                            const tagList = userPostTags[groupId.replace('-options', '')];
                            const index = tagList.indexOf(tag);
                            if (this.classList.contains('selected')) {
                                if (index === -1) tagList.push(tag);
                            } else {
                                if (index > -1) tagList.splice(index, 1);
                            }
                        }
                    });
                });
            });
            // “进入下一步” 按钮
            document.getElementById('nextToPostTestBtn').addEventListener('click', function() {
                // 验证第一部分
                const dobInput = document.getElementById('dob').value;
                if (!dobInput) {
                    alert('请填写出生日期');
                    return;
                }
                const unanswered = [];
                for (let i = 0; i < 40; i++) {
                    if (!document.querySelector(`#options-${i} .option.selected`)) {
                        unanswered.push(i + 1);
                    }
                }
                if (unanswered.length > 0) {
                    alert(`请完成第${unanswered.join(', ')}题`);
                    return;
                }
                // 隐藏当前页面，显示行为标签页面
                testPage.classList.remove('active');
                postTestPage.classList.add('active');
            });
            // “上一步” 按钮 (从行为标签页回到测试页)
            document.getElementById('backToTestBtn').addEventListener('click', function() {
                postTestPage.classList.remove('active');
                testPage.classList.add('active');
            });
            // “生成报告” 按钮
            document.getElementById('submitFinalBtn').addEventListener('click', function() {
                // 验证第二部分（可选）
                const dobInput = document.getElementById('dob').value;
                const dob = new Date(dobInput);
                const zodiac = getZodiac(dob);
                const zodiacElement = zodiacElementMap[zodiac] || "未知";
                const temperamentResult = getTemperamentResult();
                const postBigFiveScores = getPostBigFiveScores();
                // 生成并显示结果
                displayResults(zodiac, zodiacElement, temperamentResult, postBigFiveScores);
            });
            // 显示结果
            function displayResults(zodiac, zodiacElement, temperament, postBigFive) {
                const resultsContent = document.getElementById('results-content');
                const bigFive = temperament.bigFiveScores;
                // 生成分析
                const analysisResult = generateAnalysis(userPostTags, bigFive, postBigFive, zodiac);
                // 构建结果HTML
                resultsContent.innerHTML = `
                    <!-- 星座与五行 -->
                    <div class="result-item">
                        <h3><i>🌟</i> 星座与五行</h3>
                        <p><strong>你的星座：</strong> ${zodiac}</p>
                        <p><strong>五行属性：</strong> ${zodiacElement}</p>
                        <div class="tags">
                            ${zodiacTags[zodiac].map(tag => `<span class="tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                    <!-- 四液质分布 -->
                    <div class="result-item">
                        <h3><i>🧪</i> 四液质分布</h3>
                        ${Object.entries(temperament.temperamentScores).map(([type, score]) => {
                            const typeName = type === 'sanguine' ? '多血质' : 
                                           type === 'choleric' ? '胆汁质' : 
                                           type === 'melancholic' ? '抑郁质' : '粘液质';
                            return `<div style="margin: 12px 0;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                                            <span style="font-weight: 500; color: #2c3e50; font-size: 0.95em;">${typeName}</span>
                                            <span style="color: #666; font-size: 0.95em;">${score}/10</span>
                                        </div>
                                        <div class="bar-container">
                                            <div class="bar" style="width: ${score * 10}%;">${score}/10</div>
                                        </div>
                                    </div>`;
                        }).join('')}
                    </div>
                    <!-- 四液质大五人格分析 -->
                    <div class="result-item">
                        <h3><i>📊</i> 四液质大五人格</h3>
                        <table class="dimension-table">
                            <tr>
                                <th>维度</th>
                                <th>得分</th>
                                <th>满分</th>
                                <th>解读</th>
                            </tr>
                            <tr>
                                <td>开放性</td>
                                <td>${bigFive.openness}</td>
                                <td>100</td>
                                <td>${bigFive.openness > 70 ? '<span class="high-score">高度开放</span>，富有想象力和创造力' : 
                                    bigFive.openness > 50 ? '中等偏上，乐于接受新事物' : 
                                    bigFive.openness > 30 ? '中等，偏好熟悉的事物' : '<span class="low-score">较低</span>，偏好传统和常规'}</td>
                            </tr>
                            <tr>
                                <td>尽责性</td>
                                <td>${bigFive.conscientiousness}</td>
                                <td>100</td>
                                <td>${bigFive.conscientiousness > 70 ? '<span class="high-score">高度自律</span>，做事有条理' : 
                                    bigFive.conscientiousness > 50 ? '中等偏上，较为可靠' : 
                                    bigFive.conscientiousness > 30 ? '中等，有时会拖延' : '<span class="low-score">较低</span>，比较随性'}</td>
                            </tr>
                            <tr>
                                <td>外向性</td>
                                <td>${bigFive.extraversion}</td>
                                <td>100</td>
                                <td>${bigFive.extraversion > 70 ? '非常外向，精力充沛' : 
                                    bigFive.extraversion > 50 ? '中等偏上，喜欢社交' : 
                                    bigFive.extraversion > 30 ? '中等，内外向平衡' : '<span class="low-score">较低</span>，偏好独处'}</td>
                            </tr>
                            <tr>
                                <td>宜人性</td>
                                <td>${bigFive.agreeableness}</td>
                                <td>100</td>
                                <td>${bigFive.agreeableness > 70 ? '非常友善，乐于合作' : 
                                    bigFive.agreeableness > 50 ? '中等偏上，比较随和' : 
                                    bigFive.agreeableness > 30 ? '中等，有自己的主见' : '<span class="low-score">较低</span>，比较直接'}</td>
                            </tr>
                            <tr>
                                <td>神经质</td>
                                <td>${bigFive.neuroticism}</td>
                                <td>100</td>
                                <td>${bigFive.neuroticism > 70 ? '<span class="high-score">情绪波动较大</span>，容易焦虑' : 
                                    bigFive.neuroticism > 50 ? '中等偏上，情绪较敏感' : 
                                    bigFive.neuroticism > 30 ? '中等，情绪较为稳定' : '<span class="low-score">非常稳定</span>，不易焦虑'}</td>
                            </tr>
                        </table>
                        ${bigFiveMechanisms[zodiac] ? `
                        <div class="special-mechanism">
                            <h4>✨ ${zodiac} 特殊机制</h4>
                            <p>${bigFiveMechanisms[zodiac].special}</p>
                        </div>` : ''}
                    </div>
                    <!-- 后天大五人格分析 -->
                    <div class="result-item">
                        <h3><i>🎯</i> 后天大五人格</h3>
                        <table class="dimension-table">
                            <tr>
                                <th>维度</th>
                                <th>得分</th>
                                <th>满分</th>
                                <th>解读</th>
                            </tr>
                            <tr>
                                <td>开放性</td>
                                <td>${postBigFive.openness}</td>
                                <td>100</td>
                                <td>${postBigFive.openness > 70 ? '<span class="high-score">高度开放</span>，思维活跃' : 
                                    postBigFive.openness > 50 ? '中等偏上，接受新事物' : 
                                    postBigFive.openness > 30 ? '中等，偏好熟悉' : '<span class="low-score">较低</span>，偏好传统'}</td>
                            </tr>
                            <tr>
                                <td>尽责性</td>
                                <td>${postBigFive.conscientiousness}</td>
                                <td>100</td>
                                <td>${postBigFive.conscientiousness > 70 ? '<span class="high-score">高度自律</span>，有条理' : 
                                    postBigFive.conscientiousness > 50 ? '中等偏上，较为可靠' : 
                                    postBigFive.conscientiousness > 30 ? '中等，有时拖延' : '<span class="low-score">较低</span>，比较随性'}</td>
                            </tr>
                            <tr>
                                <td>外向性</td>
                                <td>${postBigFive.extraversion}</td>
                                <td>100</td>
                                <td>${postBigFive.extraversion > 70 ? '非常外向，精力充沛' : 
                                    postBigFive.extraversion > 50 ? '中等偏上，喜欢社交' : 
                                    postBigFive.extraversion > 30 ? '中等，内外向平衡' : '<span class="low-score">较低</span>，偏好独处'}</td>
                            </tr>
                            <tr>
                                <td>宜人性</td>
                                <td>${postBigFive.agreeableness}</td>
                                <td>100</td>
                                <td>${postBigFive.agreeableness > 70 ? '非常友善，乐于合作' : 
                                    postBigFive.agreeableness > 50 ? '中等偏上，比较随和' : 
                                    postBigFive.agreeableness > 30 ? '中等，有自己的主见' : '<span class="low-score">较低</span>，比较直接'}</td>
                            </tr>
                            <tr>
                                <td>神经质</td>
                                <td>${postBigFive.neuroticism}</td>
                                <td>100</td>
                                <td>${postBigFive.neuroticism > 70 ? '<span class="high-score">情绪波动较大</span>，容易焦虑' : 
                                    postBigFive.neuroticism > 50 ? '中等偏上，情绪较敏感' : 
                                    postBigFive.neuroticism > 30 ? '中等，情绪较为稳定' : '<span class="low-score">非常稳定</span>，不易焦虑'}</td>
                            </tr>
                        </table>
                    </div>
                    <!-- 人格类型标签 -->
                    <div class="result-item">
                        <h3><i>🏷️</i> 人格类型标签</h3>
                        <div class="tags">
                            ${analysisResult.personalityType.map(label => `<span class="tag">${label}</span>`).join('')}
                        </div>
                    </div>
                    <!-- 人格结构 -->
                    <div class="result-item">
                        <h3><i>🧩</i> 人格结构</h3>
                        <div class="tags">
                            ${analysisResult.personalityStructure.map(label => `<span class="tag">${label}</span>`).join('')}
                        </div>
                    </div>
                    <!-- 核心特质标签 -->
                    <div class="result-item">
                        <h3><i>🎯</i> 核心特质标签</h3>
                        <div class="tags">
                            ${analysisResult.coreTraits.map(label => `<span class="tag">${label}</span>`).join('')}
                        </div>
                    </div>
                    <!-- 环境适应力 -->
                    <div class="result-item">
                        <h3><i>🌍</i> 环境适应力</h3>
                        <div class="tags">
                            ${analysisResult.environmentAdaptation.map(label => `<span class="tag">${label}</span>`).join('')}
                        </div>
                    </div>
                    <!-- 潜在熵增警告 -->
                    <div class="result-item">
                        <h3><i>⚠️</i> 潜在熵增警告</h3>
                        <div class="tags">
                            ${analysisResult.entropyWarning.map(label => `<span class="tag">${label}</span>`).join('')}
                        </div>
                    </div>
                    <!-- 优化策略 -->
                    <div class="result-item">
                        <h3><i>🔧</i> 优化策略</h3>
                        <div class="tags">
                            ${analysisResult.optimizationStrategies.map(label => `<span class="tag">${label}</span>`).join('')}
                        </div>
                    </div>
                    <!-- 发展潜力标签 -->
                    <div class="result-item">
                        <h3><i>🚀</i> 发展潜力标签</h3>
                        <div class="tags">
                            ${analysisResult.potential.map(label => `<span class="tag">${label}</span>`).join('')}
                        </div>
                    </div>
                    <!-- 关系模式标签 -->
                    <div class="result-item">
                        <h3><i>🤝</i> 关系模式标签</h3>
                        <div class="tags">
                            ${analysisResult.relationshipPatterns.map(label => `<span class="tag">${label}</span>`).join('')}
                        </div>
                    </div>
                `;
                // 隐藏当前页面，显示结果页面
                postTestPage.classList.remove('active');
                resultsPage.classList.add('active');
            }
            // 生成分析报告，所有标签都带有量化指标
            function generateAnalysis(postTags, innateBigFive, postBigFive, zodiac) {
                const analysis = {
                    personalityType: [],
                    personalityStructure: [],
                    coreTraits: [],
                    environmentAdaptation: [],
                    entropyWarning: [],
                    optimizationStrategies: [],
                    potential: [],
                    relationshipPatterns: []
                };
                // --- 人格类型 ---
                if (postTags.mbti.includes('INTJ') || postTags.mbti.includes('ENTJ')) {
                    analysis.personalityType.push(`战略型人格`);
                }
                if (postTags.mbti.includes('INFP') || postTags.mbti.includes('ENFP')) {
                    analysis.personalityType.push(`理想型人格`);
                }
                if (postTags.mbti.includes('ISTJ') || postTags.mbti.includes('ESTJ')) {
                    analysis.personalityType.push(`执行型人格`);
                }
                if (postTags.mbti.includes('ISFP') || postTags.mbti.includes('ESFP')) {
                    analysis.personalityType.push(`体验型人格`);
                }
                if (analysis.personalityType.length === 0) {
                    analysis.personalityType.push(`平衡型人格`);
                }
                
                // --- 人格结构 ---
                if (postTags.mbti.includes('INTJ') || postTags.mbti.includes('ENTJ')) {
                    const systemScore = Math.min(100, 70 + innateBigFive.conscientiousness * 0.4);
                    analysis.personalityStructure.push(`高系统化思维倾向（系统整合力 ${systemScore}%）`);
                }
                if (postTags.mbti.includes('INTJ') || postTags.mbti.includes('ENTJ')) {
                    const emotionScore = 100 - innateBigFive.agreeableness;
                    analysis.personalityStructure.push(`架构者本能与情感雷达的动态平衡（情感折叠指数：${emotionScore}%）`);
                }
                if (postTags.mbti.includes('INFP') || postTags.mbti.includes('ENFP')) {
                    const idealismScore = Math.min(100, 60 + innateBigFive.openness * 0.6);
                    analysis.personalityStructure.push(`理想主义驱动系统（理想化程度：${idealismScore}%）`);
                }
                if (postTags.mbti.includes('ISTJ') || postTags.mbti.includes('ESTJ')) {
                    const routineScore = Math.min(100, 70 + innateBigFive.conscientiousness * 0.5);
                    analysis.personalityStructure.push(`规则依赖型认知框架（规则依赖度：${routineScore}%）`);
                }
                
                // --- 核心特质 ---
                if (innateBigFive.openness > 70) {
                    const creativityScore = innateBigFive.openness;
                    analysis.coreTraits.push(`高创造力（创造力指数：${creativityScore}%）`);
                }
                if (innateBigFive.conscientiousness > 70) {
                    const disciplineScore = innateBigFive.conscientiousness;
                    analysis.coreTraits.push(`高度自律（纪律性：${disciplineScore}%）`);
                }
                if (innateBigFive.extraversion > 70) {
                    const energyScore = innateBigFive.extraversion;
                    analysis.coreTraits.push(`高能量输出（能量指数：${energyScore}%）`);
                }
                if (innateBigFive.agreeableness > 70) {
                    const empathyScore = innateBigFive.agreeableness;
                    analysis.coreTraits.push(`高共情能力（共情指数：${empathyScore}%）`);
                }
                if (innateBigFive.neuroticism > 70) {
                    const sensitivityScore = innateBigFive.neuroticism;
                    analysis.coreTraits.push(`高情绪敏感度（敏感度：${sensitivityScore}%）`);
                }
                
                // --- 环境适应力 ---
                if (postTags.career.includes('程序员')) {
                    const logicScore = Math.min(100, 60 + innateBigFive.conscientiousness * 0.5);
                    analysis.environmentAdaptation.push(`逻辑闭环能力 +${logicScore}%`);
                }
                if (postTags.career.includes('艺术家')) {
                    const creativeScore = Math.min(100, 50 + innateBigFive.openness * 0.7);
                    analysis.environmentAdaptation.push(`非线性创造力通道激活（创造力指数：${creativeScore}%）`);
                }
                if (postTags.event.includes('重大失败')) {
                    const resilienceScore = Math.min(100, 40 + innateBigFive.neuroticism * 0.8);
                    analysis.environmentAdaptation.push(`逆境适应力 +${resilienceScore}%`);
                }
                if (postTags.event.includes('突遇贵人')) {
                    const opportunityScore = Math.min(100, 50 + innateBigFive.extraversion * 0.6);
                    analysis.environmentAdaptation.push(`机遇捕捉能力 +${opportunityScore}%`);
                }
                if (postTags.class.includes('寒门出身')) {
                    const struggleScore = Math.min(100, 60 + innateBigFive.neuroticism * 0.5);
                    analysis.environmentAdaptation.push(`逆境突破能力 +${struggleScore}%`);
                }
                if (postTags.class.includes('富裕阶层')) {
                    const comfortScore = Math.min(100, 40 + innateBigFive.conscientiousness * 0.4);
                    analysis.environmentAdaptation.push(`舒适区突破力 +${comfortScore}%`);
                }
                
                // --- 潜在熵增警告 ---
                if (postTags.class.includes('寒门出身')) {
                    const anxietyScore = Math.min(100, 50 + innateBigFive.neuroticism * 0.6);
                    analysis.entropyWarning.push(`向上流动焦虑指数：${anxietyScore}%`);
                }
                if (postTags.class.includes('富裕阶层')) {
                    const meaningScore = Math.min(100, 30 + innateBigFive.neuroticism * 0.4);
                    analysis.entropyWarning.push(`意义感真空风险 +${meaningScore}%`);
                }
                if (postTags.event.includes('重大疾病')) {
                    const stressScore = Math.min(100, 40 + innateBigFive.neuroticism * 0.7);
                    analysis.entropyWarning.push(`慢性压力积累 +${stressScore}%`);
                }
                if (innateBigFive.conscientiousness < 40) {
                    const fragilityScore = 100 - innateBigFive.conscientiousness;
                    analysis.entropyWarning.push(`目标执行链条脆弱（脆弱度：${fragilityScore}%）`);
                }
                if (innateBigFive.neuroticism > 70) {
                    const criticalScore = innateBigFive.neuroticism;
                    analysis.entropyWarning.push(`神经质指数临界值 ${criticalScore}% (高风险)`);
                }
                
                // --- 优化策略 ---
                if (postTags.event.includes('突遇贵人')) {
                    const networkScore = Math.min(100, 70 + innateBigFive.agreeableness * 0.4);
                    analysis.optimizationStrategies.push(`人脉杠杆利用率 +${networkScore}%`);
                }
                if (postTags.time.includes('夜间活跃')) {
                    const inspirationScore = Math.min(100, 50 + innateBigFive.openness * 0.6);
                    analysis.optimizationStrategies.push(`灵感峰值利用率 +${inspirationScore}%`);
                }
                if (postTags.digital.includes('表情包达人')) {
                    const expressionScore = Math.min(100, 40 + innateBigFive.openness * 0.7);
                    analysis.optimizationStrategies.push(`情感表达编码效率 +${expressionScore}%`);
                }
                if (innateBigFive.conscientiousness < 50) {
                    const focusScore = Math.min(100, 30 + innateBigFive.conscientiousness * 0.5);
                    analysis.optimizationStrategies.push(`注意力管理系统升级（专注力提升：${focusScore}%）`);
                }
                
                // --- 发展潜力 ---
                if (innateBigFive.openness > 60 && innateBigFive.conscientiousness > 50) {
                    const innovationScore = Math.min(100, 60 + innateBigFive.openness * 0.5);
                    analysis.potential.push(`创新突破潜力（创新潜力：${innovationScore}%）`);
                }
                if (innateBigFive.extraversion > 60 && innateBigFive.agreeableness > 50) {
                    const leadershipScore = Math.min(100, 50 + innateBigFive.extraversion * 0.6);
                    analysis.potential.push(`领导力发展潜力（领导力指数：${leadershipScore}%）`);
                }
                if (innateBigFive.neuroticism > 50 && innateBigFive.openness > 60) {
                    const artisticScore = Math.min(100, 70 + innateBigFive.neuroticism * 0.4);
                    analysis.potential.push(`艺术创作潜力（艺术潜能：${artisticScore}%）`);
                }
                if (innateBigFive.conscientiousness > 60 && innateBigFive.extraversion > 50) {
                    const entrepreneurialScore = Math.min(100, 60 + innateBigFive.conscientiousness * 0.4);
                    analysis.potential.push(`创业成功潜力（创业潜力：${entrepreneurialScore}%）`);
                }
                
                // --- 关系模式 ---
                if (innateBigFive.agreeableness > 70 && innateBigFive.neuroticism < 50) {
                    const harmonyScore = Math.min(100, 70 + innateBigFive.agreeableness * 0.3);
                    analysis.relationshipPatterns.push(`和谐型关系模式（和谐度：${harmonyScore}%）`);
                }
                if (innateBigFive.extraversion > 70 && innateBigFive.conscientiousness < 50) {
                    const spontaneityScore = Math.min(100, 60 + innateBigFive.extraversion * 0.4);
                    analysis.relationshipPatterns.push(`即兴型关系模式（即兴指数：${spontaneityScore}%）`);
                }
                if (innateBigFive.neuroticism > 70 && innateBigFive.agreeableness > 60) {
                    const depthScore = Math.min(100, 60 + innateBigFive.neuroticism * 0.3);
                    analysis.relationshipPatterns.push(`深度型关系模式（深度：${depthScore}%）`);
                }
                if (innateBigFive.conscientiousness > 70 && innateBigFive.extraversion < 50) {
                    const stabilityScore = Math.min(100, 70 + innateBigFive.conscientiousness * 0.3);
                    analysis.relationshipPatterns.push(`稳定型关系模式（稳定性：${stabilityScore}%）`);
                }
                
                // 添加通用标签作为兜底，也进行量化
                if (analysis.personalityType.length === 0) {
                    analysis.personalityType.push(`复合型人格`);
                }
                if (analysis.personalityStructure.length === 0) {
                    analysis.personalityStructure.push(`精密编码的情感表达机制（编码复杂度：75%）`);
                    analysis.personalityStructure.push(`风险预判与机会捕捉双重驱动（平衡指数：60%）`);
                }
                if (analysis.coreTraits.length === 0) {
                    analysis.coreTraits.push(`适应性人格特征（适应性：65%）`);
                    analysis.coreTraits.push(`情境依赖型行为模式（灵活性：70%）`);
                }
                if (analysis.environmentAdaptation.length === 0) {
                    analysis.environmentAdaptation.push(`跨界适应力 +${Math.min(100, 40 + innateBigFive.openness * 0.7)}%`);
                    analysis.environmentAdaptation.push(`情感表达畅通度 -${Math.max(10, 25 - innateBigFive.agreeableness * 0.3)}%`);
                }
                if (analysis.entropyWarning.length === 0) {
                    analysis.entropyWarning.push(`心流体验减压 -${Math.min(80, 20 + innateBigFive.openness * 0.8)}%`);
                }
                if (analysis.optimizationStrategies.length === 0) {
                    analysis.optimizationStrategies.push(`建立情感直输通道（降低编码能耗 ${Math.max(10, 30 - innateBigFive.neuroticism * 0.4)}%）`);
                    analysis.optimizationStrategies.push(`实施反完美主义训练计划（减压 ${Math.max(15, 25 - innateBigFive.neuroticism * 0.3)}%）`);
                    analysis.optimizationStrategies.push(`构建多维自我价值锚点（潜力值：★★★★☆）`);
                }
                if (analysis.potential.length === 0) {
                    analysis.potential.push(`综合发展潜力（潜力指数：★★★☆☆）`);
                    analysis.potential.push(`渐进式成长路径（成长率：60%）`);
                }
                if (analysis.relationshipPatterns.length === 0) {
                    analysis.relationshipPatterns.push(`平衡型关系模式（平衡指数：55%）`);
                    analysis.relationshipPatterns.push(`情境适应型互动风格（适应性：65%）`);
                }
                
                return analysis;
            }
        });
    </script>
</body>
</html>
