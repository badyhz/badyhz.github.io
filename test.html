<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>人格与星座综合测试</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            text-align: center;
            padding: 30px 20px;
        }
        h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .subtitle {
            font-size: 1em;
            opacity: 0.9;
        }
        .content {
            padding: 30px 20px;
        }
        .form-group {
            margin-bottom: 25px;
        }
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 1.1em;
        }
        .date-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }
        .date-input:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.2);
        }
        .question {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 18px;
            border-left: 4px solid #4facfe;
            transition: transform 0.2s ease;
        }
        .question:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .question h3 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.2em;
        }
        .options {
            display: flex;
            gap: 15px;
            margin-top: 12px;
        }
        .option {
            flex: 1;
            padding: 10px 12px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-weight: 500;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }
        .option:hover {
            border-color: #4facfe;
            background: #f0f7ff;
        }
        .option.selected {
            border-color: #4facfe;
            background: #e3f2fd;
            color: #1976d2;
            font-weight: 600;
        }
        /* 新增页面样式：后天与行为标签 */
        .post-test-page {
            display: none; /* 默认隐藏 */
            padding: 20px;
        }
        .post-test-header {
            text-align: center;
            margin-bottom: 25px;
        }
        .post-test-header h2 {
            font-size: 1.8em;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .post-test-header p {
            color: #666;
            font-size: 1em;
        }
        .tag-section {
            background: #f8f9ff;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 4px solid #4facfe;
        }
        .section-title {
            font-size: 1.4em;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .section-title i {
            margin-right: 10px;
            font-size: 1.3em;
        }
        .tag-group {
            margin-bottom: 20px;
        }
        .tag-group h3 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 1.1em;
            display: flex;
            align-items: center;
        }
        .tag-group h3 i {
            margin-right: 8px;
            font-size: 1.2em;
        }
        .tag-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }
        .tag-option {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 10px 8px;
            text-align: center;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }
        .tag-option:hover {
            border-color: #4facfe;
            background: #f0f7ff;
        }
        .tag-option.selected {
            border-color: #4facfe;
            background: #e3f2fd;
            color: #1976d2;
            font-weight: 600;
        }
        .tag-option.single-selected {
            background: #4facfe;
            color: white;
            border-color: #4facfe;
        }
        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 30px;
            font-size: 1.1em;
            border-radius: 40px;
            cursor: pointer;
            display: block;
            margin: 25px auto 0;
            transition: all 0.3s ease;
            font-weight: 600;
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 20px rgba(102, 126, 234, 0.4);
        }
        .submit-btn:active {
            transform: translateY(0);
        }
        .back-btn {
            background: #6c757d;
            margin-right: 10px;
        }
        .btn-group {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
        }
        .results {
            background: #f8f9ff;
            border-radius: 12px;
            padding: 25px;
            margin-top: 25px;
            border: 2px solid #e9ecef;
        }
        .results h2 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.6em;
        }
        .result-item {
            margin-bottom: 20px;
            padding: 16px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.08);
        }
        .result-item h3 {
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 1.2em;
            padding-bottom: 6px;
            border-bottom: 2px solid #f0f0f0;
        }
        .bar-container {
            background: #e9ecef;
            height: 20px;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        .bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            text-align: center;
            color: white;
            line-height: 20px;
            font-size: 0.85em;
            font-weight: 500;
            transition: width 1.5s ease-in-out;
        }
        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        .tag {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 0.85em;
            font-weight: 500;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .dimension-table {
            width: 100%;
            border-collapse: collapse;
            margin: 12px 0;
            font-size: 0.9em;
        }
        .dimension-table th {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            text-align: left;
            padding: 10px;
            font-weight: 600;
        }
        .dimension-table td {
            padding: 8px 10px;
            border-bottom: 1px solid #eee;
        }
        .dimension-table tr:nth-child(even) {
            background-color: #f8f9ff;
        }
        .high-score {
            color: #d32f2f;
            font-weight: 600;
        }
        .low-score {
            color: #1976d2;
            font-weight: 600;
        }
        .special-mechanism {
            background: #e8f5e8;
            padding: 10px;
            border-radius: 6px;
            margin: 12px 0;
            border-left: 3px solid #4caf50;
        }
        .special-mechanism h4 {
            color: #2e7d32;
            margin-bottom: 6px;
            font-size: 1em;
        }
        .hidden {
            display: none;
        }
        .progress {
            height: 5px;
            background: #e9ecef;
            border-radius: 2px;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 8px rgba(79, 172, 254, 0.4);
        }
        /* 平板适配 */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            header {
                padding: 25px 15px;
            }
            h1 {
                font-size: 2em;
            }
            .subtitle {
                font-size: 0.95em;
            }
            .content {
                padding: 25px 15px;
            }
            .question {
                padding: 18px;
                margin-bottom: 15px;
            }
            .question h3 {
                font-size: 1.15em;
            }
            .options {
                gap: 12px;
            }
            .option {
                padding: 9px 10px;
                font-size: 0.9em;
            }
            .submit-btn {
                padding: 13px 25px;
                font-size: 1em;
            }
            .results {
                padding: 20px;
                margin-top: 20px;
            }
            .results h2 {
                font-size: 1.5em;
            }
            .result-item {
                padding: 14px;
            }
            .result-item h3 {
                font-size: 1.15em;
            }
        }
        /* 手机适配 */
        @media (max-width: 480px) {
            body {
                padding: 15px 10px;
            }
            .container {
                margin: 5px;
                border-radius: 12px;
            }
            header {
                padding: 20px 10px;
            }
            h1 {
                font-size: 1.8em;
            }
            .subtitle {
                font-size: 0.9em;
            }
            .content {
                padding: 20px 10px;
            }
            label {
                font-size: 1em;
            }
            .date-input {
                padding: 10px;
                font-size: 1em;
            }
            .question {
                padding: 15px;
                margin-bottom: 15px;
            }
            .question h3 {
                font-size: 1.1em;
            }
            .options {
                flex-direction: column;
                gap: 10px;
            }
            .option {
                padding: 12px 10px;
                font-size: 1em;
            }
            .submit-btn {
                padding: 14px 20px;
                font-size: 1.1em;
                width: 100%;
            }
            .results {
                padding: 18px;
                margin-top: 20px;
            }
            .results h2 {
                font-size: 1.4em;
            }
            .result-item {
                padding: 12px;
            }
            .result-item h3 {
                font-size: 1.1em;
            }
            .bar-container {
                height: 18px;
            }
            .bar {
                line-height: 18px;
                font-size: 0.8em;
            }
            .tags {
                gap: 6px;
            }
            .tag {
                padding: 5px 10px;
                font-size: 0.8em;
            }
            .dimension-table {
                font-size: 0.85em;
            }
            .dimension-table th, .dimension-table td {
                padding: 6px 8px;
            }
            .special-mechanism {
                padding: 8px;
            }
            .special-mechanism h4 {
                font-size: 0.95em;
            }
            .progress {
                height: 4px;
                margin: 15px 0;
            }
        }
        /* 小屏幕特殊优化 */
        @media (max-width: 360px) {
            body {
                padding: 10px;
            }
            .container {
                margin: 5px;
            }
            header {
                padding: 15px 8px;
            }
            h1 {
                font-size: 1.6em;
            }
            .subtitle {
                font-size: 0.85em;
            }
            .content {
                padding: 15px 8px;
            }
            .question {
                padding: 12px;
            }
            .question h3 {
                font-size: 1em;
            }
            .option {
                padding: 10px 8px;
                font-size: 0.9em;
            }
            .submit-btn {
                padding: 12px 15px;
                font-size: 1em;
            }
            .results {
                padding: 15px;
            }
            .results h2 {
                font-size: 1.3em;
            }
            .result-item {
                padding: 10px;
            }
            .result-item h3 {
                font-size: 1em;
            }
            .bar {
                font-size: 0.75em;
            }
            .tag {
                padding: 4px 8px;
                font-size: 0.75em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>人格与星座综合测试</h1>
            <p class="subtitle">基于40个性格标签的深度人格分析</p>
        </header>
        <div class="content">
            <!-- 第一页：性格测试 -->
            <form id="personality-form" class="active-page">
                <div class="progress">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
                <div class="form-group">
                    <label for="dob">请输入你的出生日期：</label>
                    <input type="date" id="dob" class="date-input" required>
                </div>
                <div id="questions-container">
                    <!-- 问题将通过JavaScript动态生成 -->
                </div>
                <button type="button" id="nextToPostTestBtn" class="submit-btn">进入下一步</button>
            </form>
            <!-- 新增页面：后天与行为标签 -->
            <div id="post-test-page" class="post-test-page">
                <div class="post-test-header">
                    <h2>完善你的个人画像</h2>
                    <p>请选择以下标签，让分析更精准</p>
                </div>
                <div class="tag-section">
                    <h2 class="section-title"><i>🔄</i> 后天标签（动态雕刻）</h2>
                    <div class="tag-group">
                        <h3><i>🧠</i> MBTI</h3>
                        <div class="tag-options" id="mbti-options">
                            <div class="tag-option" data-tag="INTJ">INTJ</div>
                            <div class="tag-option" data-tag="INTP">INTP</div>
                            <div class="tag-option" data-tag="ENTJ">ENTJ</div>
                            <div class="tag-option" data-tag="ENTP">ENTP</div>
                            <div class="tag-option" data-tag="INFJ">INFJ</div>
                            <div class="tag-option" data-tag="INFP">INFP</div>
                            <div class="tag-option" data-tag="ENFJ">ENFJ</div>
                            <div class="tag-option" data-tag="ENFP">ENFP</div>
                            <div class="tag-option" data-tag="ISTJ">ISTJ</div>
                            <div class="tag-option" data-tag="ISFJ">ISFJ</div>
                            <div class="tag-option" data-tag="ESTJ">ESTJ</div>
                            <div class="tag-option" data-tag="ESFJ">ESFJ</div>
                            <div class="tag-option" data-tag="ISTP">ISTP</div>
                            <div class="tag-option" data-tag="ISFP">ISFP</div>
                            <div class="tag-option" data-tag="ESTP">ESTP</div>
                            <div class="tag-option" data-tag="ESFP">ESFP</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>💉</i> 血型</h3>
                        <div class="tag-options" id="blood-options">
                            <div class="tag-option" data-tag="A型">A型</div>
                            <div class="tag-option" data-tag="B型">B型</div>
                            <div class="tag-option" data-tag="O型">O型</div>
                            <div class="tag-option" data-tag="AB型">AB型</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>⚡</i> 关键事件</h3>
                        <div class="tag-options" id="event-options">
                            <div class="tag-option" data-tag="重大失败">重大失败</div>
                            <div class="tag-option" data-tag="突遇贵人">突遇贵人</div>
                            <div class="tag-option" data-tag="移民经历">移民经历</div>
                            <div class="tag-option" data-tag="自然灾害">自然灾害</div>
                            <div class="tag-option" data-tag="重大疾病">重大疾病</div>
                            <div class="tag-option" data-tag="意外财富">意外财富</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>💼</i> 职业烙印</h3>
                        <div class="tag-options" id="career-options">
                            <div class="tag-option" data-tag="程序员">程序员</div>
                            <div class="tag-option" data-tag="销售">销售</div>
                            <div class="tag-option" data-tag="艺术家">艺术家</div>
                            <div class="tag-option" data-tag="医生">医生</div>
                            <div class="tag-option" data-tag="教师">教师</div>
                            <div class="tag-option" data-tag="军人">军人</div>
                            <div class="tag-option" data-tag="企业家">企业家</div>
                            <div class="tag-option" data-tag="自由职业">自由职业</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>🏛️</i> 社会阶层</h3>
                        <div class="tag-options" id="class-options">
                            <div class="tag-option" data-tag="寒门出身">寒门出身</div>
                            <div class="tag-option" data-tag="中产家庭">中产家庭</div>
                            <div class="tag-option" data-tag="富裕阶层">富裕阶层</div>
                        </div>
                    </div>
                </div>
                <div class="tag-section">
                    <h2 class="section-title"><i>👣</i> 行为标签（显性表达）</h2>
                    <div class="tag-group">
                        <h3><i>🛒</i> 消费印记</h3>
                        <div class="tag-options" id="spend-options">
                            <div class="tag-option" data-tag="奢侈品">奢侈品</div>
                            <div class="tag-option" data-tag="知识付费">知识付费</div>
                            <div class="tag-option" data-tag="极简主义">极简主义</div>
                            <div class="tag-option" data-tag="冲动消费">冲动消费</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>👥</i> 社交指纹</h3>
                        <div class="tag-options" id="social-options">
                            <div class="tag-option" data-tag="群聊主导者">群聊主导者</div>
                            <div class="tag-option" data-tag="倾听者">倾听者</div>
                            <div class="tag-option" data-tag="段子手">段子手</div>
                            <div class="tag-option" data-tag="社交回避">社交回避</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>⏱️</i> 时间分配</h3>
                        <div class="tag-options" id="time-options">
                            <div class="tag-option" data-tag="夜间活跃">夜间活跃</div>
                            <div class="tag-option" data-tag="晨型人">晨型人</div>
                            <div class="tag-option" data-tag="碎片化">碎片化</div>
                        </div>
                    </div>
                    <div class="tag-group">
                        <h3><i>📱</i> 数字肢体语言</h3>
                        <div class="tag-options" id="digital-options">
                            <div class="tag-option" data-tag="点赞狂魔">点赞狂魔</div>
                            <div class="tag-option" data-tag="已读不回">已读不回</div>
                            <div class="tag-option" data-tag="长文党">长文党</div>
                        </div>
                    </div>
                </div>
                <div class="btn-group">
                    <button type="button" id="backToTestBtn" class="submit-btn back-btn">上一步</button>
                    <button type="button" id="submitFinalBtn" class="submit-btn">生成我的人格报告</button>
                </div>
            </div>
            <!-- 最终结果页面 -->
            <div class="results hidden" id="results">
                <h2>我的人格画像</h2>
                <div id="results-content">
                    <!-- 结果将通过JavaScript动态生成 -->
                </div>
            </div>
        </div>
    </div>
    <script>
        // 四液质标签和评分规则
        const temperamentTags = {
            sanguine: [
                { label: "社交", openness: 6, conscientiousness: 4, extraversion: 9, agreeableness: 7, neuroticism: 3 },
                { label: "活泼", openness: 6, conscientiousness: 3, extraversion: 9, agreeableness: 6, neuroticism: 3 },
                { label: "情绪波动", openness: 5, conscientiousness: 2, extraversion: 7, agreeableness: 5, neuroticism: 8 },
                { label: "精力旺盛", openness: 5, conscientiousness: 5, extraversion: 9, agreeableness: 5, neuroticism: 3 },
                { label: "热情", openness: 6, conscientiousness: 4, extraversion: 8, agreeableness: 7, neuroticism: 4 },
                { label: "兴趣广泛", openness: 9, conscientiousness: 2, extraversion: 7, agreeableness: 6, neuroticism: 4 },
                { label: "容易厌倦", openness: 8, conscientiousness: 1, extraversion: 6, agreeableness: 4, neuroticism: 5 },
                { label: "健谈", openness: 5, conscientiousness: 3, extraversion: 9, agreeableness: 6, neuroticism: 3 },
                { label: "善于适应", openness: 7, conscientiousness: 5, extraversion: 7, agreeableness: 6, neuroticism: 3 },
                { label: "优柔寡断", openness: 6, conscientiousness: 2, extraversion: 5, agreeableness: 6, neuroticism: 7 }
            ],
            choleric: [
                { label: "自信", openness: 5, conscientiousness: 8, extraversion: 8, agreeableness: 4, neuroticism: 2 },
                { label: "控制", openness: 4, conscientiousness: 9, extraversion: 7, agreeableness: 2, neuroticism: 5 },
                { label: "行动", openness: 5, conscientiousness: 9, extraversion: 7, agreeableness: 4, neuroticism: 3 },
                { label: "竞争", openness: 5, conscientiousness: 8, extraversion: 7, agreeableness: 3, neuroticism: 4 },
                { label: "直接", openness: 4, conscientiousness: 6, extraversion: 8, agreeableness: 3, neuroticism: 4 },
                { label: "冒险", openness: 8, conscientiousness: 5, extraversion: 8, agreeableness: 3, neuroticism: 4 },
                { label: "目标导向", openness: 4, conscientiousness: 9, extraversion: 7, agreeableness: 3, neuroticism: 3 },
                { label: "领导倾向", openness: 5, conscientiousness: 8, extraversion: 8, agreeableness: 4, neuroticism: 3 },
                { label: "易怒", openness: 3, conscientiousness: 4, extraversion: 6, agreeableness: 2, neuroticism: 9 },
                { label: "非黑即白", openness: 2, conscientiousness: 7, extraversion: 6, agreeableness: 3, neuroticism: 5 }
            ],
            melancholic: [
                { label: "敏感", openness: 7, conscientiousness: 6, extraversion: 2, agreeableness: 7, neuroticism: 9 },
                { label: "温柔", openness: 5, conscientiousness: 5, extraversion: 3, agreeableness: 9, neuroticism: 6 },
                { label: "封闭", openness: 6, conscientiousness: 5, extraversion: 1, agreeableness: 5, neuroticism: 7 },
                { label: "共情", openness: 7, conscientiousness: 5, extraversion: 3, agreeableness: 9, neuroticism: 6 },
                { label: "完美主义", openness: 6, conscientiousness: 9, extraversion: 3, agreeableness: 5, neuroticism: 8 },
                { label: "过度分析", openness: 9, conscientiousness: 8, extraversion: 2, agreeableness: 5, neuroticism: 8 },
                { label: "自省", openness: 8, conscientiousness: 7, extraversion: 2, agreeableness: 6, neuroticism: 7 },
                { label: "创造力", openness: 9, conscientiousness: 6, extraversion: 4, agreeableness: 5, neuroticism: 7 },
                { label: "悲观", openness: 5, conscientiousness: 6, extraversion: 2, agreeableness: 4, neuroticism: 9 },
                { label: "思考", openness: 9, conscientiousness: 7, extraversion: 3, agreeableness: 5, neuroticism: 6 }
            ],
            phlegmatic: [
                { label: "冷静", openness: 4, conscientiousness: 6, extraversion: 4, agreeableness: 7, neuroticism: 1 },
                { label: "耐心", openness: 3, conscientiousness: 7, extraversion: 3, agreeableness: 8, neuroticism: 2 },
                { label: "稳定", openness: 3, conscientiousness: 7, extraversion: 4, agreeableness: 7, neuroticism: 2 },
                { label: "倾听", openness: 4, conscientiousness: 5, extraversion: 3, agreeableness: 9, neuroticism: 3 },
                { label: "规律", openness: 2, conscientiousness: 8, extraversion: 4, agreeableness: 6, neuroticism: 3 },
                { label: "避免冲突", openness: 3, conscientiousness: 5, extraversion: 3, agreeableness: 9, neuroticism: 4 },
                { label: "务实", openness: 4, conscientiousness: 8, extraversion: 4, agreeableness: 6, neuroticism: 3 },
                { label: "物质主导", openness: 1, conscientiousness: 7, extraversion: 4, agreeableness: 5, neuroticism: 3 },
                { label: "被动", openness: 3, conscientiousness: 2, extraversion: 2, agreeableness: 6, neuroticism: 3 },
                { label: "决策迟缓", openness: 3, conscientiousness: 3, extraversion: 3, agreeableness: 6, neuroticism: 5 }
            ]
        };
        // 生成判断题
        const questions = [];
        const allTags = [];
        // 收集所有标签
        Object.keys(temperamentTags).forEach(temperament => {
            temperamentTags[temperament].forEach(tagData => {
                allTags.push({
                    ...tagData,
                    temperament: temperament
                });
            });
        });
        // 生成判断题
        allTags.forEach(tag => {
            const question = {
                text: `我是一个${tag.label}的人`,
                tag: tag
            };
            questions.push(question);
        });
        // 星座标签
        const zodiacTags = {
            "白羊座": ["开拓者", "行动派", "竞争者", "急先锋", "无畏者"],
            "金牛座": ["守护者", "享乐家", "固执者", "品味家", "稳定器"],
            "双子座": ["信息猎手", "沟通达人", "好奇心驱动者", "多面手", "思维跳跃者"],
            "巨蟹座": ["情感容器", "记忆守护者", "家庭中心", "敏感雷达", "情绪共鸣者"],
            "狮子座": ["舞台中心", "自信发光体", "领导欲强者", "荣耀追求者", "热情传播者"],
            "处女座": ["细节控", "系统优化师", "完美主义者", "健康管理者", "逻辑洁癖者"],
            "天秤座": ["关系调停者", "美学鉴赏家", "犹豫决策者", "社交润滑剂", "公平捍卫者"],
            "天蝎座": ["深度探索者", "秘密守护者", "情感强度者", "重生实践者", "洞察猎人"],
            "射手座": ["自由追寻者", "哲学思考者", "冒险家", "真理探索者", "乐观传播者"],
            "摩羯座": ["目标攀登者", "责任承担者", "长期主义者", "权威塑造者", "现实梦想家"],
            "水瓶座": ["未来设想者", "规则挑战者", "群体观察者", "科技爱好者", "人道主义者"],
            "双鱼座": ["共情连接者", "艺术梦境者", "逃避现实者", "灵性探索者", "边界模糊者"]
        };
        // 星座维度标签和修正规则
        const zodiacDimensionData = {
            "白羊座": {
                traits: "高外向性 + 低宜人性 + 中低尽责性",
                dimensions: [
                    { trait: "开放性", high: "冒险实验者", low: "理论厌恶者", correction: "年龄＞35岁→开放性每年-2%" },
                    { trait: "尽责性", high: "竞争性自律", low: "细节忽略者", correction: "职业=运动员→尽责性+15%" },
                    { trait: "外向性", high: "能量风暴", low: "独处焦虑者", correction: "恋爱中→外向性暂时+10%" },
                    { trait: "宜人性", high: "战时义气", low: "日常怼王", correction: "团队危机→宜人性瞬间+30%" },
                    { trait: "神经质", high: "暴怒快消型", low: "疼痛钝感者", correction: "健身习惯→神经质-25%" }
                ]
            },
            "金牛座": {
                traits: "低开放性 + 高尽责性 + 中低外向性",
                dimensions: [
                    { trait: "开放性", high: "感官鉴赏家", low: "颠覆恐惧者", correction: "米其林餐厅体验→开放性+5%/次" },
                    { trait: "尽责性", high: "资产守卫者", low: "弹性缺失者", correction: "经济危机→尽责性飙升至MAX" },
                    { trait: "外向性", high: "美食社交家", low: "邀请拒绝者", correction: "品鉴会场景→外向性+20%" },
                    { trait: "宜人性", high: "稳定供应者", low: "资源吝啬者", correction: "家人求助→宜人性突破阈值" },
                    { trait: "神经质", high: "变更焦虑者", low: "生理耐痛者", correction: "计划被打乱→神经质+50%" }
                ]
            },
            "双子座": {
                traits: "高开放性 + 中低尽责性 + 高外向性",
                dimensions: [
                    { trait: "开放性", high: "信息水母", low: "深度恐惧者", correction: "新语言学习→开放性+8%" },
                    { trait: "尽责性", high: "多线程崩坏者", low: "Deadline艺术家", correction: "自由职业→尽责性-15%" },
                    { trait: "外向性", high: "社交变色龙", low: "能量透支者", correction: "陌生人群→外向性自动+25%" },
                    { trait: "宜人性", high: "话题救场者", low: "隐形毒舌者", correction: "微信聊天→宜人性+30%" },
                    { trait: "神经质", high: "信息过载焦虑", low: "情绪闪存者", correction: "冥想训练→神经质-12%" }
                ]
            },
            "巨蟹座": {
                traits: "高宜人性 + 高神经质 + 低开放性",
                dimensions: [
                    { trait: "开放性", high: "怀旧考古者", low: "移民抗拒者", correction: "祖宅保留→开放性锁定最低" },
                    { trait: "尽责性", high: "家庭CEO", low: "职场让渡者", correction: "子女出生→尽责性+40%" },
                    { trait: "外向性", high: "亲密圈话痨", low: "陌生人静音", correction: "家族聚会→外向性+50%" },
                    { trait: "宜人性", high: "情感血库", low: "控制型付出", correction: "被背叛→宜人性永久-20%" },
                    { trait: "神经质", high: "天气预报式情绪", low: "危机超镇定", correction: "家人晚归→神经质瞬时+200%" }
                ]
            },
            "狮子座": {
                traits: "极高外向性 + 低宜人性 + 中高神经质",
                dimensions: [
                    { trait: "开放性", high: "舞台创新者", low: "传统捍卫者", correction: "观众＞10人→开放性+15%" },
                    { trait: "尽责性", high: "荣耀驱动者", low: "琐事拒绝者", correction: "获奖可能→尽责性MAX" },
                    { trait: "外向性", high: "焦点引力场", low: "冷落抑郁者", correction: "Instagram点赞＜预期→外向性-10%" },
                    { trait: "宜人性", high: "保护型霸道", low: "权威挑战者", correction: "下属崇拜→宜人性+25%" },
                    { trait: "神经质", high: "面子恐慌症", low: "表演型镇定", correction: "竞争对手出现→神经质+35%" }
                ]
            },
            "处女座": {
                traits: "极高尽责性 + 低开放性 + 中高神经质",
                dimensions: [
                    { trait: "开放性", high: "系统优化者", low: "随机厌恶者", correction: "Excel宏编写→开放性+5%" },
                    { trait: "尽责性", high: "纠错永动机", low: "他人标准强迫症", correction: "合作者低尽责→神经质+30%" },
                    { trait: "外向性", high: "精准社交者", low: "能耗计算者", correction: "行业会议→外向性精确启动" },
                    { trait: "宜人性", high: "服务型毒舌", low: "卫生警察", correction: "医院环境→宜人性-50%" },
                    { trait: "神经质", high: "细节灾难化", low: "流程镇定剂", correction: "备用方案≥3个→神经质-18%" }
                ]
            },
            "天秤座": {
                traits: "高宜人性 + 中高开放性 + 低尽责性（决策相关）",
                dimensions: [
                    { trait: "开放性", high: "美学仲裁者", low: "选择瘫痪者", correction: "画廊到访→开放性+8%/小时" },
                    { trait: "尽责性", high: "社交礼仪师", low: "文件拖延者", correction: "他人监督→尽责性+25%" },
                    { trait: "外向性", high: "氛围调节器", low: "能量借贷者", correction: "冲突场合→外向性瞬时+50%" },
                    { trait: "宜人性", high: "关系平衡术", low: "隐形操纵者", correction: "离婚诉讼→宜人性-40%" },
                    { trait: "神经质", high: "和谐焦虑症", low: "表面镇定者", correction: "被当众批评→神经质+300%" }
                ],
                special: "「美学仲裁者」与「选择瘫痪者」共存时 → 购买决策需外部强制截止时间"
            },
            "天蝎座": {
                traits: "极高神经质 + 低宜人性 + 中高开放性（暗黑创意）",
                dimensions: [
                    { trait: "开放性", high: "深渊探索者", low: "信任封锁者", correction: "深夜时段→开放性+20%" },
                    { trait: "尽责性", high: "复仇计划师", low: "日常敷衍者", correction: "目标锁定→尽责性MAX" },
                    { trait: "外向性", high: "暗流吸引体", low: "社交休眠者", correction: "神秘感营造→外向性逆向+15%" },
                    { trait: "宜人性", high: "极端忠诚者", low: "控制型施虐", correction: "背叛发生→宜人性永久归零" },
                    { trait: "神经质", high: "疑心雷达网", low: "危机超频者", correction: "信息不透明→神经质每小时+10%" }
                ],
                special: "当「深渊探索者」与「复仇计划师」同时激活 → 产生创造性破坏能量（如创业/艺术突破）"
            },
            "射手座": {
                traits: "极高开放性 + 低尽责性 + 中低神经质",
                dimensions: [
                    { trait: "开放性", high: "知识游牧民", low: "责任蒸发者", correction: "异国生活→开放性+5%/年" },
                    { trait: "尽责性", high: "乐观拖延症", low: "契约过敏者", correction: "旅行计划→尽责性-30%" },
                    { trait: "外向性", high: "文化传教士", low: "深度社交无能", correction: "新朋友在场→外向性+35%" },
                    { trait: "宜人性", high: "天真直言者", low: "冒犯无感者", correction: "宗教讨论→宜人性-50%" },
                    { trait: "神经质", high: "自由受限焦虑", low: "生理痛觉迟钝", correction: "定居→神经质每月+8%" }
                ],
                special: "承诺回避率 = 0.7 × 年龄 - (0.3 × 已育子女数)"
            },
            "摩羯座": {
                traits: "极高尽责性 + 低外向性 + 中低宜人性",
                dimensions: [
                    { trait: "开放性", high: "制度改良者", low: "传统水泥墙", correction: "管理岗位→开放性-10%" },
                    { trait: "尽责性", high: "十年规划师", low: "情感账本家", correction: "经济衰退→尽责性+25%" },
                    { trait: "外向性", high: "阶梯社交家", low: "团建幽灵", correction: "行业峰会→外向性精确释放" },
                    { trait: "宜人性", high: "资源互惠者", low: "功利裁判官", correction: "家族利益→宜人性+40%" },
                    { trait: "神经质", high: "成就焦虑症", low: "疼痛麻木者", correction: "排名下降→神经质+15%/位" }
                ],
                special: "30岁后「情感账本家」标签强度与年薪增长呈负相关（r=-0.62）"
            },
            "水瓶座": {
                traits: "极高开放性 + 低宜人性 + 中低神经质",
                dimensions: [
                    { trait: "开放性", high: "未来考古狂", low: "世俗过敏者", correction: "科技新闻→开放性+3%/条" },
                    { trait: "尽责性", high: "反规则执行者", low: "项目弃养者", correction: "社会实验→尽责性+50%" },
                    { trait: "外向性", high: "概念传教士", low: "亲密恐惧者", correction: "TED演讲→外向性+100%" },
                    { trait: "宜人性", high: "人道主义战士", low: "情商黑洞", correction: "群体利益→宜人性瞬间激活" },
                    { trait: "神经质", high: "系统僵化焦虑", low: "个人批评屏蔽", correction: "官僚主义→神经质+20%/接触小时" }
                ],
                special: "「反规则执行者」在硅谷创业环境中转化为核心竞争力"
            },
            "双鱼座": {
                traits: "极高神经质 + 高宜人性 + 中低尽责性",
                dimensions: [
                    { trait: "开放性", high: "幻象酿酒师", low: "现实逃逸者", correction: "酒精摄入→开放性+15%" },
                    { trait: "尽责性", high: "情绪型尽责", low: "承诺蒸发者", correction: "恋人期待→尽责性+60%" },
                    { trait: "外向性", high: "共情海绵体", low: "能量枯竭者", correction: "受害者叙事→外向性异常高涨" },
                    { trait: "宜人性", high: "边界溶解者", low: "自我献祭癖", correction: "被求助→宜人性突破阈值" },
                    { trait: "神经质", high: "全频段接收器", low: "艺术镇定剂", correction: "阴雨天→神经质+30%" }
                ],
                special: "当「幻象酿酒师」与「艺术镇定剂」同时激活 → 产生高价值创造性作品"
            }
        };
        // 用于存储用户选择的后天和行为标签
        const userPostTags = {
            mbti: [],
            blood: [],
            event: [],
            career: [],
            class: [],
            spend: [],
            social: [],
            time: [],
            digital: []
        };
        // 页面加载完成后生成问题
        document.addEventListener('DOMContentLoaded', function() {
            const questionsContainer = document.getElementById('questions-container');
            questions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <h3>第${index + 1}/40题</h3>
                    <p style="margin-bottom: 12px; color: #555; line-height: 1.4;">${question.text}？</p>
                    <div class="options" id="options-${index}">
                        <div class="option" data-value="yes">是</div>
                        <div class="option" data-value="no">否</div>
                    </div>
                `;
                questionsContainer.appendChild(questionDiv);
                // 添加点击事件
                const options = questionDiv.querySelectorAll('.option');
                options.forEach(option => {
                    option.addEventListener('click', function() {
                        // 移除其他选项的选中状态
                        options.forEach(opt => opt.classList.remove('selected'));
                        // 添加当前选项的选中状态
                        this.classList.add('selected');
                        // 设置隐藏的输入值
                        let hiddenInput = document.querySelector(`#hidden-input-${index}`);
                        if (!hiddenInput) {
                            hiddenInput = document.createElement('input');
                            hiddenInput.type = 'hidden';
                            hiddenInput.name = `q${index}`;
                            hiddenInput.id = `hidden-input-${index}`;
                            document.getElementById('personality-form').appendChild(hiddenInput);
                        }
                        hiddenInput.value = this.getAttribute('data-value');
                    });
                });
            });
            // 添加输入监听器更新进度条
            const optionElements = document.querySelectorAll('.option');
            optionElements.forEach(option => {
                option.addEventListener('click', updateProgress);
            });
            // ============ 新增页面的交互逻辑 ============
            const postTestPage = document.getElementById('post-test-page');
            const personalityForm = document.getElementById('personality-form');
            const nextToPostTestBtn = document.getElementById('nextToPostTestBtn');
            const backToTestBtn = document.getElementById('backToTestBtn');
            const submitFinalBtn = document.getElementById('submitFinalBtn');
            // 为所有可选项添加点击事件
            document.querySelectorAll('.tag-options').forEach(group => {
                const groupId = group.id;
                const options = group.querySelectorAll('.tag-option');
                options.forEach(option => {
                    option.addEventListener('click', function() {
                        const tag = this.getAttribute('data-tag');
                        const isSingleSelect = ['mbti', 'blood'].some(prefix => groupId.startsWith(prefix));
                        if (isSingleSelect) {
                            // 单选逻辑 (MBTI, 血型)
                            options.forEach(opt => opt.classList.remove('selected', 'single-selected'));
                            this.classList.add('single-selected');
                            // 清空数组并添加新选择
                            userPostTags[groupId.replace('-options', '')] = [tag];
                        } else {
                            // 多选逻辑
                            this.classList.toggle('selected');
                            const tagList = userPostTags[groupId.replace('-options', '')];
                            const index = tagList.indexOf(tag);
                            if (this.classList.contains('selected')) {
                                if (index === -1) tagList.push(tag);
                            } else {
                                if (index > -1) tagList.splice(index, 1);
                            }
                        }
                    });
                });
            });
            // “进入下一步” 按钮
            nextToPostTestBtn.addEventListener('click', function() {
                // 验证第一部分
                const dobInput = document.getElementById('dob').value;
                if (!dobInput) {
                    alert('请填写出生日期');
                    return;
                }
                const unanswered = [];
                for (let i = 0; i < questions.length; i++) {
                    if (!document.querySelector(`#hidden-input-${i}`)) {
                        unanswered.push(i + 1);
                    }
                }
                if (unanswered.length > 0) {
                    alert(`请完成第${unanswered.join(', ')}题`);
                    return;
                }
                // 隐藏第一页面，显示第二页面
                personalityForm.classList.remove('active-page');
                personalityForm.style.display = 'none';
                postTestPage.style.display = 'block';
            });
            // “上一步” 按钮
            backToTestBtn.addEventListener('click', function() {
                postTestPage.style.display = 'none';
                personalityForm.style.display = 'block';
            });
            // “生成报告” 按钮
            submitFinalBtn.addEventListener('click', function() {
                // 这里可以添加对后天和行为标签的验证
                // 获取出生日期
                const dobInput = document.getElementById('dob').value;
                const dob = new Date(dobInput);
                const zodiac = getZodiac(dob);
                const zodiacElement = getZodiacElement(zodiac);
                // 获取四液质和大五人格结果
                const temperament = getTemperamentResult();
                // 显示结果
                displayResults(zodiac, temperament, temperament.bigFiveScores, zodiacElement, userPostTags);
            });
        });
        // 更新进度条
        function updateProgress() {
            const totalQuestions = questions.length;
            const answeredQuestions = document.querySelectorAll('.option.selected').length;
            const progressPercent = (answeredQuestions / totalQuestions) * 100;
            document.getElementById('progress-bar').style.width = progressPercent + '%';
        }
        // 获取星座
        function getZodiac(dob) {
            const month = dob.getMonth() + 1;
            const day = dob.getDate();
            if ((month === 3 && day >= 21) || (month === 4 && day <= 19)) return "白羊座";
            if ((month === 4 && day >= 20) || (month === 5 && day <= 20)) return "金牛座";
            if ((month === 5 && day >= 21) || (month === 6 && day <= 20)) return "双子座";
            if ((month === 6 && day >= 21) || (month === 7 && day <= 22)) return "巨蟹座";
            if ((month === 7 && day >= 23) || (month === 8 && day <= 22)) return "狮子座";
            if ((month === 8 && day >= 23) || (month === 9 && day <= 22)) return "处女座";
            if ((month === 9 && day >= 23) || (month === 10 && day <= 22)) return "天秤座";
            if ((month === 10 && day >= 23) || (month === 11 && day <= 21)) return "天蝎座";
            if ((month === 11 && day >= 22) || (month === 12 && day <= 21)) return "射手座";
            if ((month === 12 && day >= 22) || (month === 1 && day <= 19)) return "摩羯座";
            if ((month === 1 && day >= 20) || (month === 2 && day <= 18)) return "水瓶座";
            if ((month === 2 && day >= 19) || (month === 3 && day <= 20)) return "双鱼座";
            return "未知星座";
        }
        // 获取星座元素
        function getZodiacElement(sign) {
            const fireSigns = ["白羊座", "狮子座", "射手座"];
            const earthSigns = ["金牛座", "处女座", "摩羯座"];
            const airSigns = ["双子座", "天秤座", "水瓶座"];
            const waterSigns = ["巨蟹座", "天蝎座", "双鱼座"];
            if (fireSigns.includes(sign)) return "火象";
            if (earthSigns.includes(sign)) return "土象";
            if (airSigns.includes(sign)) return "风象";
            if (waterSigns.includes(sign)) return "水象";
            return "未知";
        }
        // 计算四液质结果
        function getTemperamentResult() {
            const scores = { sanguine: 0, choleric: 0, melancholic: 0, phlegmatic: 0 };
            const bigFiveScores = { openness: 0, conscientiousness: 0, extraversion: 0, agreeableness: 0, neuroticism: 0 };
            for (let i = 0; i < questions.length; i++) {
                const selectedValue = document.querySelector(`#hidden-input-${i}`)?.value;
                if (selectedValue === 'yes') {
                    const tag = questions[i].tag;
                    // 四液质计分
                    scores[tag.temperament] += 1;
                    // 大五人格计分
                    bigFiveScores.openness += tag.openness;
                    bigFiveScores.conscientiousness += tag.conscientiousness;
                    bigFiveScores.extraversion += tag.extraversion;
                    bigFiveScores.agreeableness += tag.agreeableness;
                    bigFiveScores.neuroticism += tag.neuroticism;
                }
            }
            // 将大五人格分数标准化到0-100范围
            const maxPossible = 40 * 9; // 40题 * 最高分9
            const minPossible = 0;
            const range = maxPossible - minPossible;
            const normalizedBigFive = {
                openness: Math.round((bigFiveScores.openness / range) * 100),
                conscientiousness: Math.round((bigFiveScores.conscientiousness / range) * 100),
                extraversion: Math.round((bigFiveScores.extraversion / range) * 100),
                agreeableness: Math.round((bigFiveScores.agreeableness / range) * 100),
                neuroticism: Math.round((bigFiveScores.neuroticism / range) * 100)
            };
            return { 
                temperamentScores: scores, 
                bigFiveScores: normalizedBigFive 
            };
        }
        // 显示结果
        function displayResults(zodiac, temperament, bigFive, zodiacElement, postTags) {
            const resultsDiv = document.getElementById('results');
            const resultsContent = document.getElementById('results-content');
            // 找出主要气质
            const dominant = Object.keys(temperament.temperamentScores).reduce((a, b) => 
                temperament.temperamentScores[a] > temperament.temperamentScores[b] ? a : b
            );
            const temperamentNames = {
                sanguine: "多血质",
                choleric: "胆汁质", 
                melancholic: "抑郁质",
                phlegmatic: "粘液质"
            };
            // MBTI 映射
            let mbtiMapping = '';
            let bigFiveMapping = '';
            let zodiacTemperamentMapping = '';
            switch (dominant) {
                case 'sanguine':
                    mbtiMapping = '外向感知型（EP）如 ENFP、ESFP';
                    bigFiveMapping = '高外向性 · 高开放性';
                    break;
                case 'choleric':
                    mbtiMapping = '外向判断型（EJ）如 ENTJ、ESTJ';
                    bigFiveMapping = '高尽责性 · 低宜人性';
                    break;
                case 'melancholic':
                    mbtiMapping = '内向直觉型（IN）如 INFJ、INTJ';
                    bigFiveMapping = '高开放性 · 高神经质';
                    break;
                case 'phlegmatic':
                    mbtiMapping = '内向感觉型（IS）如 ISFJ、ISTJ';
                    bigFiveMapping = '高宜人性 · 低神经质';
                    break;
            }
            // 星座与液质映射
            if (['白羊座', '狮子座', '射手座'].includes(zodiac)) {
                zodiacTemperamentMapping = '火象星座 · 胆汁质+多血质';
            } else if (['巨蟹座', '天蝎座', '双鱼座'].includes(zodiac)) {
                zodiacTemperamentMapping = '水象星座 · 抑郁质';
            } else if (['金牛座', '处女座', '摩羯座'].includes(zodiac)) {
                zodiacTemperamentMapping = '土象星座 · 粘液质';
            } else if (['双子座', '天秤座', '水瓶座'].includes(zodiac)) {
                zodiacTemperamentMapping = '风象星座 · 多血质';
            } else {
                zodiacTemperamentMapping = '未知映射';
            }

            // === 新增：根据用户输入和计算结果，从标签库中动态生成分析内容 ===
            function generateAnalysis() {
                const analysis = {
                    personalityStructure: [],
                    environmentAdaptation: [],
                    entropyWarning: [],
                    optimizationStrategies: []
                };

                // 示例逻辑：根据MBTI、职业、大五分数等条件生成标签
                if (postTags.mbti.includes('INTJ') || postTags.mbti.includes('ENTJ')) {
                    analysis.personalityStructure.push("架构者本能与情感雷达的动态平衡");
                    analysis.personalityStructure.push("高系统化思维倾向（系统整合力87%）");
                }
                if (postTags.career.includes('程序员')) {
                    analysis.environmentAdaptation.push("逻辑闭环能力 +42%");
                    analysis.environmentAdaptation.push("认知灵活性 +35%");
                }
                if (bigFive.neuroticism > 60) {
                    analysis.entropyWarning.push("神经质指数临界值 63% (安全阈值 ＜60%)");
                    analysis.entropyWarning.push("完美主义执念增压 30%");
                }
                if (postTags.social.includes('社交回避')) {
                    analysis.entropyWarning.push("社交能耗超标（每周恢复需求28h）");
                }
                if (postTags.time.includes('夜间活跃')) {
                    analysis.optimizationStrategies.push("引入30%无序性创造活动");
                }
                if (zodiac === "天蝎座") {
                    analysis.optimizationStrategies.push("激活天蝎座情感深度资源");
                }

                // 添加通用标签
                analysis.personalityStructure.push("精密编码的情感表达机制");
                analysis.personalityStructure.push("风险预判与机会捕捉双重驱动");
                analysis.personalityStructure.push("情感折叠指数：63%");

                analysis.environmentAdaptation.push("跨界适应力 +28%");
                analysis.environmentAdaptation.push("文化归属感 -25%");
                analysis.environmentAdaptation.push("仪式需求 -20%");
                analysis.environmentAdaptation.push("情感表达畅通度 -17%");

                analysis.entropyWarning.push("马拉松调节减压 -22%");
                analysis.entropyWarning.push("心流体验减压 -18%");
                analysis.entropyWarning.push("认知重构能力缓冲 +12%");

                analysis.optimizationStrategies.push("建立情感直输通道（降低编码能耗）");
                analysis.optimizationStrategies.push("实施反完美主义训练计划");
                analysis.optimizationStrategies.push("构建多维自我价值锚点");

                return analysis;
            }

            const analysisResult = generateAnalysis();

            // 人格类型标签
            const personalityTypeLabels = [
                "矛盾协调型人格",
                "动态平衡架构师",
                "风险感知型创新者",
                "情感折叠型表达者"
            ];

            // 核心特质标签
            const coreTraitLabels = [
                "系统整合者",
                "跨界适应者",
                "熵值管理者",
                "矛盾协调者"
            ];

            // 发展潜力标签
            const potentialLabels = [
                "认知弹性潜力值：★★★★☆",
                "情感表达潜力值：★★★☆☆",
                "压力耐受潜力值：★★★★★",
                "创新突破潜力值：★★★★☆"
            ];

            // 关系模式标签
            const relationshipLabels = [
                "策略性亲和关系模式",
                "深度连接偏好",
                "情感雷达接收模式",
                "边界守护者倾向"
            ];

            resultsContent.innerHTML = `
                <div class="result-item">
                    <h3>核心人格特质</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; margin-top: 10px;">
                        <div style="text-align: center; padding: 12px; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); border-radius: 10px;">
                            <div style="font-weight: 600; color: #2c3e50; font-size: 0.9em;">主要气质</div>
                            <div style="font-size: 1.1em; margin-top: 4px; color: #4facfe;">${temperamentNames[dominant]}</div>
                        </div>
                        <div style="text-align: center; padding: 12px; background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); border-radius: 10px;">
                            <div style="font-weight: 600; color: #2c3e50; font-size: 0.9em;">星座</div>
                            <div style="font-size: 1.1em; margin-top: 4px; color: #d32f2f;">${zodiac}</div>
                        </div>
                        <div style="text-align: center; padding: 12px; background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%); border-radius: 10px;">
                            <div style="font-weight: 600; color: #2c3e50; font-size: 0.9em;">元素</div>
                            <div style="font-size: 1.1em; margin-top: 4px; color: #1976d2;">${zodiacElement}</div>
                        </div>
                    </div>
                </div>
                <div class="result-item">
                    <h3>四液质分布</h3>
                    ${Object.entries(temperament.temperamentScores).map(([type, score]) => `
                        <div style="margin: 12px 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                                <span style="font-weight: 500; color: #2c3e50; font-size: 0.95em;">${temperamentNames[type]}</span>
                                <span style="color: #666; font-size: 0.95em;">${score}/40</span>
                            </div>
                            <div class="bar-container">
                                <div class="bar" style="width: ${score * 2.5}%;">${score}/40</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                <div class="result-item">
                    <h3>大五人格分析</h3>
                    ${Object.entries(bigFive).map(([trait, score]) => {
                        const traitName = {
                            openness: '开放性',
                            conscientiousness: '尽责性', 
                            extraversion: '外向性',
                            agreeableness: '宜人性',
                            neuroticism: '神经质'
                        }[trait];
                        return `
                            <div style="margin: 12px 0;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                                    <span style="font-weight: 500; color: #2c3e50; font-size: 0.95em;">${traitName}</span>
                                    <span style="color: #666; font-size: 0.95em;">${Math.round(score)}%</span>
                                </div>
                                <div class="bar-container">
                                    <div class="bar" style="width: ${score}%;">${Math.round(score)}%</div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>

                <!-- 新增：人格拓扑分析报告 -->
                <div class="result-item" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <!-- 人格结构解析 -->
                    <div style="background: #1a1a2e; border-radius: 12px; padding: 20px; border-left: 4px solid #4facfe;">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="color: #4facfe; margin-right: 8px;">
                                <path d="M12 4L12 12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 12V20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M8 12L8 16C8 17.1046 8.89543 18 10 18H14C15.1046 18 16 17.1046 16 16V12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <h3 style="color: white; margin: 0;">人格结构解析</h3>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            ${analysisResult.personalityStructure.map(item => `
                                <div style="display: flex; align-items: center; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                    <div style="width: 16px; height: 16px; background: #4facfe; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; opacity: 0.8;">
                                        <svg width="10" height="10" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="color: white;">
                                            <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </div>
                                    <span style="color: #e0e0e0; font-size: 0.95em;">${item}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- 环境适应系数 -->
                    <div style="background: #1a1a2e; border-radius: 12px; padding: 20px; border-left: 4px solid #4facfe;">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="color: #4facfe; margin-right: 8px;">
                                <path d="M12 16L12 20M12 8L12 12M12 4L12 8M12 20L12 24M12 24L16 20M12 24L8 20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <h3 style="color: white; margin: 0;">环境适应系数</h3>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            ${analysisResult.environmentAdaptation.map(item => {
                                const isPositive = item.includes('+');
                                const icon = isPositive ? '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 12H19M12 5L19 12M12 19L5 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>' : '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19 5L12 12L5 5M19 19L12 12L5 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                                const color = isPositive ? '#4caf50' : '#f44336';
                                return `
                                    <div style="display: flex; align-items: center; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                        <div style="width: 16px; height: 16px; background: ${color}; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; opacity: 0.8;">
                                            ${icon}
                                        </div>
                                        <span style="color: ${isPositive ? '#4caf50' : '#f44336'}; font-size: 0.95em;">${item}</span>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>

                    <!-- 熵值预警系统 -->
                    <div style="background: #1a1a2e; border-radius: 12px; padding: 20px; border-left: 4px solid #4facfe;">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="color: #4facfe; margin-right: 8px;">
                                <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 8V12M12 16H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <h3 style="color: white; margin: 0;">熵值预警系统</h3>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            ${analysisResult.entropyWarning.map(item => {
                                const hasWarning = item.includes('警告') || item.includes('临界') || item.includes('超标') || item.includes('增压');
                                const icon = hasWarning ? '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 8V12M12 16H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>' : '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 16L12 20M12 8L12 12M12 4L12 8M12 20L12 24M12 24L16 20M12 24L8 20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
                                const color = hasWarning ? '#f44336' : '#2196F3';
                                return `
                                    <div style="display: flex; align-items: center; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                        <div style="width: 16px; height: 16px; background: ${color}; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; opacity: 0.8;">
                                            ${icon}
                                        </div>
                                        <span style="color: ${hasWarning ? '#f44336' : '#2196F3'}; font-size: 0.95em;">${item}</span>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>

                    <!-- 优化策略 -->
                    <div style="background: #1a1a2e; border-radius: 12px; padding: 20px; border-left: 4px solid #4facfe;">
                        <div style="display: flex; align-items: center; margin-bottom: 15px;">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="color: #4facfe; margin-right: 8px;">
                                <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 8V12M12 16H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <h3 style="color: white; margin: 0;">优化策略</h3>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            ${analysisResult.optimizationStrategies.map(item => `
                                <div style="display: flex; align-items: center; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                                    <div style="width: 16px; height: 16px; background: #4facfe; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; opacity: 0.8;">
                                        <svg width="10" height="10" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="color: white;">
                                            <path d="M12 8V12M12 16H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </div>
                                    <span style="color: #e0e0e0; font-size: 0.95em;">${item}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>

                <!-- 人格类型标签 -->
                <div class="result-item">
                    <h3>人格类型标签</h3>
                    <div class="tags">
                        ${personalityTypeLabels.map(label => `<span class="tag">${label}</span>`).join('')}
                    </div>
                </div>

                <!-- 核心特质标签 -->
                <div class="result-item">
                    <h3>核心特质标签</h3>
                    <div class="tags">
                        ${coreTraitLabels.map(label => `<span class="tag">${label}</span>`).join('')}
                    </div>
                </div>

                <!-- 发展潜力标签 -->
                <div class="result-item">
                    <h3>发展潜力标签</h3>
                    <div class="tags">
                        ${potentialLabels.map(label => `<span class="tag">${label}</span>`).join('')}
                    </div>
                </div>

                <!-- 关系模式标签 -->
                <div class="result-item">
                    <h3>关系模式标签</h3>
                    <div class="tags">
                        ${relationshipLabels.map(label => `<span class="tag">${label}</span>`).join('')}
                    </div>
                </div>
            `;
            resultsDiv.classList.remove('hidden');
            document.getElementById('post-test-page').style.display = 'none';
        }
    </script>
</body>
</html>
