<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>å…«å­—æ’ç›˜ + å–œç”¨ç¥ & 60å¹´è¿åŠ¿è¯„åˆ†</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/lunar-javascript/lunar.js"></script>
  <style>
    body{font-family:"Noto Sans SC",system-ui,-apple-system,Segoe UI,Roboto,"PingFang SC","Microsoft YaHei",sans-serif;background:#f6f7fb;margin:0;padding:24px;color:#1f2937}
    h1{margin:0 0 12px 0;font-size:24px;text-align:center}
    .status{font-weight:600;margin:8px 0 16px 0;text-align:center}
    .green{color:#16a34a}.red{color:#ef4444}.orange{color:#f59e0b}
    .card{background:#fff;border-radius:12px;padding:16px;box-shadow:0 6px 24px rgba(17,24,39,.06);margin-top:16px}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .row input[type="number"]{width:90px}
    .btn{padding:10px 14px;border:none;border-radius:10px;cursor:pointer;font-weight:600}
    .btn-primary{background:#22c55e;color:#fff}.btn-secondary{background:#3b82f6;color:#fff}.btn-test{background:#f59e0b;color:#fff}
    .grid{display:grid;grid-template-columns:repeat(4,minmax(160px,1fr));gap:8px}
    .kpi{background:#0b1020;color:#fff;border-radius:12px;padding:12px}
    .kpi h3{margin:0 0 6px 0;font-size:13px;opacity:.8;font-weight:500}
    .kpi div{font-size:18px;font-weight:700}
    .code{font-family:ui-monospace,Menlo,Consolas,monospace;background:#0b1020;color:#cbd5e1;padding:10px;border-radius:8px;white-space:pre-wrap}
    table{width:100%;border-collapse:collapse;font-size:14px}
    th,td{border-bottom:1px solid #e5e7eb;padding:10px 8px;text-align:left}
    th{background:#f9fafb;position:sticky;top:0;z-index:1}
    .scroll{max-height:60vh;overflow:auto;border-radius:12px}
    .tag{display:inline-block;padding:2px 8px;border-radius:999px;font-size:12px;margin-right:6px;margin-bottom:4px;border:1px solid rgba(31,41,55,.12)}
    .tag-red{color:#ef4444;border-color:#fecaca;background:#fff1f2}
    .tag-green{color:#16a34a;border-color:#bbf7d0;background:#f0fdf4}
    .tag-amber{color:#b45309;border-color:#fde68a;background:#fffbeb}
    .muted{color:#6b7280;font-size:13px}
    .goodCell{font-weight:700}
  </style>
</head>
<body>
  <h1>å…«å­—æ’ç›˜ + å–œç”¨ç¥ & å‡ºç”Ÿå60å¹´è¿åŠ¿è¯„åˆ†</h1>
  <div id="engineStatus" class="status">æ’ç›˜å¼•æ“ï¼šlunar-javascriptï¼ˆåŠ è½½ä¸­â€¦ï¼‰</div>

  <div class="card">
    <div class="row">
      <label>å‡ºç”Ÿæ—¥æœŸæ—¶é—´ï¼š</label>
      <input type="number" id="year" placeholder="å¹´">
      <input type="number" id="month" placeholder="æœˆ">
      <input type="number" id="day" placeholder="æ—¥">
      <input type="number" id="hour" placeholder="æ—¶">
      <button class="btn btn-primary" id="btnBazi">ç”Ÿæˆå…«å­—</button>
      <button class="btn btn-secondary" id="btnLuck">ç”Ÿæˆå‡ºç”Ÿå60å¹´è¿åŠ¿</button>
      <button class="btn btn-test" id="btnTest">è¿è¡Œå†…å»ºæµ‹è¯•</button>
    </div>
    <div class="muted" style="margin-top:6px">æç¤ºï¼šå°æ—¶æœªçŸ¥å¯å…ˆå¡« 12ï¼›å¦‚é‡ç½‘ç»œæ³¢åŠ¨å¯¼è‡´è„šæœ¬æœªåŠ è½½ï¼Œè¯·åˆ·æ–°ã€‚</div>
  </div>

  <div class="card" id="panelBazi" style="display:none">
    <h2>ğŸ“œ å…«å­—æ’ç›˜ & å‘½æ ¼</h2>
    <div class="grid" id="kpi"></div>
    <pre class="code" id="baziText"></pre>
    <div id="yongshenBox" class="muted"></div>
  </div>

  <div class="card" id="panelLuck" style="display:none">
    <h2>ğŸ“ˆ å‡ºç”Ÿå 60 å¹´è¿åŠ¿è¯„åˆ†ï¼ˆæŒ‰å–œç”¨ç¥åŠ æƒï¼‰</h2>
    <div class="muted" style="margin-bottom:8px">
      æ ‡è®°ï¼š<span class="tag">æœ¬å‘½å¹´</span>/<span class="tag">å†²å¤ªå²</span>/<span class="tag">åˆå¤ªå²</span>ï¼Œ
      <span class="tag tag-red">é‡å¤§è½¬æŠ˜</span>ï¼ˆå­åˆå¯é…‰ï¼‰ï¼Œ
      <span class="tag tag-green">è´µäºº</span>ï¼ˆå¹´å¹²åˆæ—¥å¹²ï¼‰ï¼Œ
      <span class="tag tag-amber">å°äºº</span>ï¼ˆå¹´å¹²å†²æ—¥å¹²ï¼‰ã€‚è¯„åˆ†=åŸºç¡€åˆ†+å–œç”¨åŠ æˆâˆ’å¿Œç¥æ‰£åˆ†ï¼ˆå¹²>æ”¯ï¼‰ã€‚
    </div>

    <div class="card" id="summaryCard" style="background:#f9fafb">
      <h3 style="margin:4px 0 8px 0;">å¹´åº¦æ‘˜è¦</h3>
      <div id="summaryText" class="muted">ç”Ÿæˆåæ˜¾ç¤ºæœ€æ—º TOP5 / éœ€è°¨æ… TOP5ã€‚</div>
    </div>

    <div class="scroll" style="margin-top:8px">
      <table id="luckTable">
        <thead>
          <tr>
            <th>åº</th><th>å¹´ä»½</th><th>å¹´å¹²æ”¯</th><th>ç”Ÿè‚–</th>
            <th>æ ‡ç­¾</th><th>è¯„åˆ†</th><th>è¯´æ˜</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

<script>
  // å¼•æ“çŠ¶æ€
  window.addEventListener('load', () => {
    const st = document.getElementById('engineStatus');
    if (window.Solar && window.Lunar) { st.textContent = 'æ’ç›˜å¼•æ“ï¼šlunar-javascriptï¼ˆå·²å°±ç»ªï¼‰'; st.classList.add('green'); }
    else { st.textContent = 'æ’ç›˜å¼•æ“ï¼šlunar-javascriptï¼ˆåŠ è½½å¤±è´¥ï¼‰'; st.classList.add('red'); }
  });

  // æ˜ å°„è¡¨
  const wuxingGan = {ç”²:'æœ¨',ä¹™:'æœ¨',ä¸™:'ç«',ä¸:'ç«',æˆŠ:'åœŸ',å·±:'åœŸ',åºš:'é‡‘',è¾›:'é‡‘',å£¬:'æ°´',ç™¸:'æ°´'};
  const wuxingZhi = {å­:'æ°´',ä¸‘:'åœŸ',å¯…:'æœ¨',å¯:'æœ¨',è¾°:'åœŸ',å·³:'ç«',åˆ:'ç«',æœª:'åœŸ',ç”³:'é‡‘',é…‰:'é‡‘',æˆŒ:'åœŸ',äº¥:'æ°´'};
  const fourZheng = new Set(['å­','åˆ','å¯','é…‰']);
  const clashSX = {é¼ :'é©¬',ç‰›:'ç¾Š',è™:'çŒ´',å…”:'é¸¡',é¾™:'ç‹—',è›‡:'çŒª',é©¬:'é¼ ',ç¾Š:'ç‰›',çŒ´:'è™',é¸¡:'å…”',ç‹—:'é¾™',çŒª:'è›‡'};
  const heSX = {é¼ :'ç‰›',ç‰›:'é¼ ',è™:'çŒª',çŒª:'è™',å…”:'ç‹—',ç‹—:'å…”',é¾™:'é¸¡',é¸¡:'é¾™',è›‡:'çŒ´',çŒ´:'è›‡',é©¬:'ç¾Š',ç¾Š:'é©¬'};
  const ganHe = {ç”²:'å·±',ä¹™:'åºš',ä¸™:'è¾›',ä¸:'å£¬',æˆŠ:'ç™¸',å·±:'ç”²',åºš:'ä¹™',è¾›:'ä¸™',å£¬:'ä¸',ç™¸:'æˆŠ'};
  const ganChong = {ç”²:'åºš',ä¹™:'è¾›',ä¸™:'å£¬',ä¸:'ç™¸',æˆŠ:'ç”²',å·±:'ä¹™',åºš:'ç”²',è¾›:'ä¹™',å£¬:'ä¸™',ç™¸:'ä¸'};

  // å·¥å…·
  function needInputs() {
    const y = parseInt(document.getElementById('year').value,10);
    const m = parseInt(document.getElementById('month').value,10);
    const d = parseInt(document.getElementById('day').value,10);
    const h = parseInt(document.getElementById('hour').value,10);
    if (!y || !m || !d || isNaN(h)) { alert('è¯·è¾“å…¥å®Œæ•´çš„ å¹´/æœˆ/æ—¥/æ—¶'); return null; }
    if (!window.Solar || !window.Lunar) { alert('å¼•æ“æœªåŠ è½½æˆåŠŸ'); return null; }
    return {y,m,d,h};
  }

  // å‘½æ ¼&å–œç”¨ç¥æ¨å¯¼ï¼ˆç®€åŒ–ç‰ˆï¼Œå¯æ›¿æ¢ä¸ºæ›´ç»†è‡´æµæ´¾è§„åˆ™ï¼‰
  function inferMingJuAndYong(baziEC) {
    const stems = [baziEC.getYearGan(), baziEC.getMonthGan(), baziEC.getDayGan(), baziEC.getTimeGan()];
    const wuxCount = {æœ¨:0,ç«:0,åœŸ:0,é‡‘:0,æ°´:0};
    stems.forEach(g => { const w = wuxingGan[g]; if (w) wuxCount[w]++; });

    const dayGan = baziEC.getDayGan();
    const dayMaster = wuxingGan[dayGan];

    // å¼ºå¼±ï¼ˆéå¸¸ç®€åŒ–ï¼šä»¥å¤©å¹²æ•°+æœˆä»¤æƒé‡ç²—åˆ¤ï¼‰
    let strongWeak = 'ä¸­å’Œ';
    if (wuxCount[dayMaster] >= 3) strongWeak = 'åå¼º';
    if (wuxCount[dayMaster] <= 1) strongWeak = 'åå¼±';

    // å–œç”¨/å¿Œç¥é›†åˆ
    let yongSet = new Set(), jiSet = new Set();
    if (strongWeak === 'åå¼º') {
      // å–œæ³„è€—/å…‹åˆ¶ï¼šæ—¥ä¸»æ‰€å…‹ã€å…‹æ—¥ä¸»
      // äº”è¡Œç›¸å…‹ï¼šæœ¨å…‹åœŸã€åœŸå…‹æ°´ã€æ°´å…‹ç«ã€ç«å…‹é‡‘ã€é‡‘å…‹æœ¨
      const ke = {æœ¨:'åœŸ',ç«:'é‡‘',åœŸ:'æ°´',é‡‘:'æœ¨',æ°´:'ç«'};
      const beiKe = Object.fromEntries(Object.entries(ke).map(([a,b])=>[b,a]));
      yongSet.add(ke[dayMaster]); yongSet.add(beiKe[dayMaster]);
      // å¿ŒåŒå…šï¼šæ¯”åŠ«
      jiSet.add(dayMaster);
    } else if (strongWeak === 'åå¼±') {
      // å–œåŒå…š/ç”ŸåŠ©ï¼šåŒå…ƒç´ +ç”Ÿæˆ‘
      // ç”Ÿï¼šæœ¨ç”Ÿç«ã€ç«ç”ŸåœŸã€åœŸç”Ÿé‡‘ã€é‡‘ç”Ÿæ°´ã€æ°´ç”Ÿæœ¨
      const sheng = {æœ¨:'ç«',ç«:'åœŸ',åœŸ:'é‡‘',é‡‘:'æ°´',æ°´:'æœ¨'};
      const shengWo = Object.fromEntries(Object.entries(sheng).map(([a,b])=>[b,a]));
      yongSet.add(dayMaster); yongSet.add(shengWo[dayMaster]);
      // å¿Œå…‹æˆ‘/æ³„æˆ‘
      const ke = {æœ¨:'åœŸ',ç«:'é‡‘',åœŸ:'æ°´',é‡‘:'æœ¨',æ°´:'ç«'};
      const woSheng = sheng[dayMaster];
      jiSet.add(ke[dayMaster]); jiSet.add(woSheng);
    } else {
      // ä¸­å’Œï¼šæ€»ä½“å¹³è¡¡ï¼Œè½»å¾®åå¥½ æœˆä»¤ã€å²è¿è¡¥é½ç¼ºé¡¹ï¼ˆè¿™é‡Œç»™å‡ºå»ºè®®ï¼šç¼ºå•¥è¡¥å•¥ï¼‰
      // æˆ‘ä»¬æŠŠâ€œç¼ºå£æœ€å¤§çš„ä¸¤é¡¹â€æš‚å®šä¸ºå–œç”¨
      const order = Object.entries(wuxCount).sort((a,b)=>a[1]-b[1]);
      yongSet.add(order[0][0]); yongSet.add(order[1][0]);
      // å€¼æœ€å¤§çš„ä¸€é¡¹æš‚ä½œå¿Œ
      jiSet.add(order[4][0]);
    }
    return { dayGan, dayMaster, strongWeak, wuxCount, yongSet, jiSet };
  }

  // å…«å­—ç”Ÿæˆ
  function generateBazi() {
    const inps = needInputs(); if (!inps) return;
    const {y,m,d,h} = inps;
    const solar = Solar.fromYmdHms(y,m,d,h,0,0);
    const lunar = solar.getLunar();
    const ec = lunar.getEightChar();

    const lines = [];
    lines.push(`å…¬å†ï¼š${y}-${m}-${d} ${String(h).padStart(2,'0')}:00`);
    lines.push(`å†œå†ï¼š${lunar.toFullString()}`);
    lines.push(`å…«å­—ï¼š${ec.toString()}`);
    lines.push(`å››æŸ±ï¼šå¹´ ${ec.getYear()}ï½œæœˆ ${ec.getMonth()}ï½œæ—¥ ${ec.getDay()}ï½œæ—¶ ${ec.getTime()}`);
    lines.push(`æ—¥ä¸»ï¼ˆæ—¥å¹²ï¼‰ï¼š${ec.getDayGan()}`);

    document.getElementById('panelBazi').style.display='block';
    document.getElementById('baziText').textContent = lines.join('\n');

    // KPI
    const kpi = document.getElementById('kpi');
    kpi.innerHTML='';
    const kpis = [
      ['ç”Ÿè‚–', lunar.getYearShengXiao()],
      ['æ—¥å¹²', ec.getDayGan()],
      ['å¹´å¹²æ”¯', ec.getYear()],
      ['æœˆä»¤ï¼ˆæœˆæ”¯ï¼‰', ec.getMonthZhi()],
    ];
    kpis.forEach(([k,v])=>{
      const el=document.createElement('div'); el.className='kpi';
      el.innerHTML=`<h3>${k}</h3><div>${v}</div>`;
      kpi.appendChild(el);
    });

    // å–œç”¨ç¥
    const info = inferMingJuAndYong(ec);
    const wc = info.wuxCount;
    document.getElementById('yongshenBox').innerHTML =
      `äº”è¡Œåˆ†å¸ƒï¼šæœ¨${wc['æœ¨']} ç«${wc['ç«']} åœŸ${wc['åœŸ']} é‡‘${wc['é‡‘']} æ°´${wc['æ°´']}<br>
       å‘½å±€å¼ºå¼±ï¼š<b>${info.strongWeak}</b>ï¼›æ—¥ä¸»ï¼š<b>${info.dayMaster}</b><br>
       æ¨èå–œç”¨ç¥ï¼š<b>${[...info.yongSet].join('ã€')}</b>ï¼›å¿Œç¥ï¼š<b>${[...info.jiSet].join('ã€')}</b>`;
  }

  // 60å¹´è¿åŠ¿ï¼ˆæŒ‰å–œç”¨ç¥åŠ æƒè¯„åˆ†ï¼‰
  function generateLuck60() {
    const inps = needInputs(); if (!inps) return;
    const {y,m,d,h} = inps;

    // åŸºå‡†
    const baseSolar = Solar.fromYmdHms(y,m,d,h,0,0);
    const baseLunar = baseSolar.getLunar();
    const baseEC = baseLunar.getEightChar();
    const { dayGan, yongSet, jiSet } = inferMingJuAndYong(baseEC);
    const myAnimal = baseLunar.getYearShengXiao();

    const tbody=document.querySelector('#luckTable tbody');
    tbody.innerHTML='';

    const rows = [];

    for (let i=0; i<60; i++){
      const Y = y + i;
      const s = Solar.fromYmdHms(Y,m,d,h,0,0);
      const l = s.getLunar();
      const gz = l.getYearInGanZhi();
      const gan = l.getYearGan(); // æ›´ç¨³å¦¥åœ°å–å¹´å¹²
      const zhi = l.getYearZhi(); // å¹´æ”¯
      const animal = l.getYearShengXiao();

      // æ ‡ç­¾ï¼šå¤ªå²ã€æœ¬å‘½/å†²/åˆ
      const tags = [];
      if (animal === myAnimal) tags.push('<span class="tag">æœ¬å‘½å¹´</span>');
      if (clashSX[myAnimal] === animal) tags.push('<span class="tag">å†²å¤ªå²</span>');
      if (heSX[myAnimal] === animal) tags.push('<span class="tag">åˆå¤ªå²</span>');

      // é‡å¤§è½¬æŠ˜
      if (fourZheng.has(zhi)) tags.push('<span class="tag tag-red">é‡å¤§è½¬æŠ˜</span>');

      // è´µäºº/å°äººï¼ˆå¹´å¹²ä¸æ—¥å¹²ï¼‰
      if (ganHe[dayGan] === gan) tags.push('<span class="tag tag-green">è´µäºº</span>');
      if (ganChong[dayGan] === gan) tags.push('<span class="tag tag-amber">å°äºº</span>');

      // â€”â€” å¹´åº¦è¯„åˆ† â€”â€” //
      // åŸºç¡€ 50ï¼›å¹´å¹²å–œç”¨ +20ï¼›å¹´æ”¯å–œç”¨ +12ï¼›å¹´å¹²å¿Œç¥ -20ï¼›å¹´æ”¯å¿Œç¥ -12ï¼›
      // åˆå¤ªå² +5ï¼›å†²å¤ªå² -5ï¼›æœ¬å‘½å¹´ Â±0ï¼ˆåªæç¤ºï¼‰ï¼›å››æ­£ +4ï¼ˆè§†ä¸ºèŠ‚ç‚¹èƒ½é‡ï¼‰
      let score = 50;
      const ganW = wuxingGan[gan], zhiW = wuxingZhi[zhi];
      const marks = [];

      if (yongSet.has(ganW)) { score += 20; marks.push(`å¹´å¹²${gan}å±${ganW}âˆˆå–œç”¨ +20`); }
      if (yongSet.has(zhiW)) { score += 12; marks.push(`å¹´æ”¯${zhi}å±${zhiW}âˆˆå–œç”¨ +12`); }
      if (jiSet.has(ganW))   { score -= 20; marks.push(`å¹´å¹²${gan}å±${ganW}âˆˆå¿Œç¥ âˆ’20`); }
      if (jiSet.has(zhiW))   { score -= 12; marks.push(`å¹´æ”¯${zhi}å±${zhiW}âˆˆå¿Œç¥ âˆ’12`); }

      if (animal === myAnimal) { marks.push('æœ¬å‘½å¹´ï¼ˆæç¤ºï¼‰'); }
      if (clashSX[myAnimal] === animal) { score -= 5; marks.push('å†²å¤ªå² âˆ’5'); }
      if (heSX[myAnimal] === animal) { score += 5; marks.push('åˆå¤ªå² +5'); }
      if (fourZheng.has(zhi)) { score += 4; marks.push('å››æ­£èŠ‚ç‚¹ +4'); }

      // é™å¹…
      score = Math.max(0, Math.min(100, score));

      // è¯´æ˜æ–‡æ¡ˆï¼ˆç®€çŸ­å»ºè®®ï¼‰
      const adv = buildAdvice({score, gan, ganW, zhi, zhiW, tags});

      rows.push({Y, gz, animal, tags:tags.join(' '), score, adv});
    }

    // æ‘˜è¦ï¼šTop5 / Bottom5
    const top5 = [...rows].sort((a,b)=>b.score-a.score).slice(0,5);
    const low5 = [...rows].sort((a,b)=>a.score-b.score).slice(0,5);
    const sText = [
      `æœ€æ—º TOP5ï¼š${top5.map(r=>`${r.Y}(${r.gz}ï¼š${r.score})`).join('ï¼Œ')}`,
      `éœ€è°¨æ… TOP5ï¼š${low5.map(r=>`${r.Y}(${r.gz}ï¼š${r.score})`).join('ï¼Œ')}`
    ].join(' ï½œ ');
    document.getElementById('summaryText').textContent = sText;

    // æ¸²æŸ“è¡¨æ ¼
    rows.forEach((r,idx)=>{
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${idx+1}</td>
        <td>${r.Y}${(new Date().getFullYear()===r.Y)?'ï¼ˆä»Šå¹´ï¼‰':''}</td>
        <td>${r.gz}</td>
        <td>${r.animal}</td>
        <td>${r.tags}</td>
        <td class="goodCell">${r.score}</td>
        <td>${r.adv}</td>`;
      tbody.appendChild(tr);
    });

    document.getElementById('panelLuck').style.display='block';
  }

  function buildAdvice({score, gan, ganW, zhi, zhiW, tags}) {
    const t = (tags||[]).toString();
    const parts = [];
    if (score >= 80) parts.push('é¡ºåŠ¿æ‰©å¼ ï¼Œå®œç«‹ç›®æ ‡ä¸å†²åˆºå…³é”®é¡¹ç›®');
    else if (score >= 65) parts.push('ç¨³ä¸­æœ‰è¿›ï¼Œé€‚åˆè¿­ä»£ä¸ç§¯ç´¯');
    else if (score >= 50) parts.push('å¹³ç¨³è¿è¥ï¼Œæ§åˆ¶æˆæœ¬ä¸é£é™©');
    else if (score >= 35) parts.push('ä¿å®ˆä¸ºä¸»ï¼Œèšç„¦ä¿®å¤ä¸å­¦ä¹ ');
    else parts.push('è°¨æ…è¡Œäº‹ï¼Œé¿å…é‡èµ„äº§ä¸å¤§å†³ç­–');

    // æ ¹æ®å¹²æ”¯äº”è¡Œè¡¥å……ä¸€å¥
    parts.push(`å¹²${gan}ï¼ˆ${ganW}ï¼‰æ”¯${zhi}ï¼ˆ${zhiW}ï¼‰`);
    if (t.includes('è´µäºº')) parts.push('è´µäººåŠ©åŠ›ï¼Œå®œåˆä½œ/èƒŒä¹¦');
    if (t.includes('å°äºº')) parts.push('äººäº‹è€ƒéªŒï¼Œæå‰åšé¢„æ¡ˆ');
    if (t.includes('é‡å¤§è½¬æŠ˜')) parts.push('èŠ‚ç‚¹å¹´ï¼Œé€‚åˆå®šæ–¹å‘/æ¬è¿/è½¬å‹');

    return parts.joinï¼› // è¿™é‡Œç”¨ä¸­æ–‡åˆ†å·æ›´è‡ªç„¶
  }

  // å†…å»ºæµ‹è¯•
  function runTests() {
    const st = document.getElementById('engineStatus');
    st.textContent = 'æ’ç›˜å¼•æ“ï¼šlunar-javascriptï¼ˆæµ‹è¯•ä¸­â€¦ï¼‰'; st.classList.remove('green','red'); st.classList.add('orange');
    const out=[];
    try{
      if(!window.Solar||!window.Lunar) throw new Error('å¼•æ“æœªåŠ è½½');
      out.push('âœ… å¼•æ“å…¨å±€å¯¹è±¡å­˜åœ¨');
      const s1=Solar.fromYmd(1990,1,1);
      const l1=s1.getLunar();
      out.push('âœ… 1990-01-01 è½¬å†œå†ï¼š'+l1.toFullString());
      const ec=l1.getEightChar();
      out.push('âœ… å››æŸ±ï¼š'+[ec.getYear(),ec.getMonth(),ec.getDay(),ec.getTime()].join(' '));
      const s2=Solar.fromYmdHms(2000,5,20,14,0,0);
      out.push('âœ… fromYmdHmsï¼š'+s2.toString());
      st.textContent='æ’ç›˜å¼•æ“ï¼šlunar-javascriptï¼ˆå·²å°±ç»ªï¼‰'; st.classList.remove('orange'); st.classList.add('green');
    }catch(e){
      out.push('âŒ æµ‹è¯•å¤±è´¥ï¼š'+e.message);
      st.textContent='æ’ç›˜å¼•æ“ï¼šlunar-javascriptï¼ˆåŠ è½½å¤±è´¥ï¼‰'; st.classList.remove('orange'); st.classList.add('red');
    }
    document.getElementById('panelBazi').style.display='block';
    document.getElementById('baziText').textContent=out.join('\n');
    document.getElementById('kpi').innerHTML='';
    document.getElementById('yongshenBox').innerHTML='';
  }

  // äº‹ä»¶ç»‘å®š
  document.getElementById('btnBazi').addEventListener('click', generateBazi);
  document.getElementById('btnLuck').addEventListener('click', generateLuck60);
  document.getElementById('btnTest').addEventListener('click', runTests);
</script>
</body>
</html>
