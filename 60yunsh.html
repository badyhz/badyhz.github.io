<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>八字排盘与合盘分析</title>
  <style>
    body { font-family: "Microsoft YaHei", sans-serif; margin: 20px; background: #f8f8f8; }
    h2 { margin-top: 20px; color: #333; }
    .tabs { display: flex; margin-bottom: 20px; }
    .tab { padding: 10px 20px; cursor: pointer; background: #ddd; margin-right: 5px; border-radius: 5px 5px 0 0; }
    .tab.active { background: #fff; font-weight: bold; border: 1px solid #ccc; border-bottom: none; }
    .tab-content { display: none; background: #fff; padding: 20px; border: 1px solid #ccc; border-radius: 0 5px 5px 5px; }
    .tab-content.active { display: block; }
    label { display: inline-block; width: 100px; }
    input, select { margin-bottom: 10px; padding: 5px; }
    button { padding: 10px 20px; background: #007bff; color: #fff; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #0056b3; }
    .result { margin-top: 20px; padding: 15px; background: #fafafa; border: 1px solid #ddd; border-radius: 5px; }
    .highlight-red { color: red; font-weight: bold; }
    .highlight-green { color: green; font-weight: bold; }
    .highlight-orange { color: orange; font-weight: bold; }
  </style>
</head>
<body>
  <h1>八字排盘与合盘分析</h1>

  <div class="tabs">
    <div class="tab active" data-target="personal">个人排盘</div>
    <div class="tab" data-target="compatibility">合盘分析</div>
  </div>

  <!-- 个人排盘 -->
  <div id="personal" class="tab-content active">
    <h2>个人排盘</h2>
    <form id="personalForm">
      <label>年份：</label><input type="number" id="pYear" value="1990"><br>
      <label>月份：</label><input type="number" id="pMonth" value="1"><br>
      <label>日期：</label><input type="number" id="pDay" value="1"><br>
      <label>时辰：</label><input type="number" id="pHour" value="12"><br>
      <label>性别：</label>
      <select id="pGender"><option value="男">男</option><option value="女">女</option></select><br>
      <label>出生地：</label><input type="text" id="pCity" placeholder="城市"><br>
      <label>真太阳时：</label>
      <select id="pSolar"><option value="否">否</option><option value="是">是</option></select><br>
      <button type="button" onclick="analyzePersonal()">运行排盘</button>
    </form>
    <div id="personalResult" class="result"></div>
  </div>

  <!-- 合盘分析 -->
  <div id="compatibility" class="tab-content">
    <h2>合盘分析</h2>
    <form id="compatibilityForm">
      <h3>甲方信息</h3>
      <label>年份：</label><input type="number" id="aYear" value="1990"><br>
      <label>月份：</label><input type="number" id="aMonth" value="1"><br>
      <label>日期：</label><input type="number" id="aDay" value="1"><br>
      <label>时辰：</label><input type="number" id="aHour" value="12"><br>

      <h3>乙方信息</h3>
      <label>年份：</label><input type="number" id="bYear" value="1992"><br>
      <label>月份：</label><input type="number" id="bMonth" value="2"><br>
      <label>日期：</label><input type="number" id="bDay" value="2"><br>
      <label>时辰：</label><input type="number" id="bHour" value="8"><br>

      <button type="button" onclick="analyzeCompatibility()">运行合盘</button>
    </form>
    <div id="compatibilityResult" class="result"></div>
  </div>

  <script>
    // Tab 切换
    document.querySelectorAll(".tab").forEach(tab => {
      tab.addEventListener("click", function() {
        document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
        document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("active"));
        this.classList.add("active");
        document.getElementById(this.dataset.target).classList.add("active");
      });
    });

    // 八字基础排盘（演示版，简化）
    function getBazi(year, month, day, hour) {
      const tg = ["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"];
      const dz = ["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"];
      let yTG = tg[(year-4)%10];
      let yDZ = dz[(year-4)%12];
      let mTG = tg[(month+year)%10];
      let mDZ = dz[(month+year)%12];
      let dTG = tg[(day+month)%10];
      let dDZ = dz[(day+month)%12];
      let hTG = tg[(hour+day)%10];
      let hDZ = dz[Math.floor(hour/2)%12];
      return { year: yTG+yDZ, month: mTG+mDZ, day: dTG+dDZ, hour: hTG+hDZ };
    }

    function analyzePersonal() {
      let year = parseInt(document.getElementById("pYear").value);
      let month = parseInt(document.getElementById("pMonth").value);
      let day = parseInt(document.getElementById("pDay").value);
      let hour = parseInt(document.getElementById("pHour").value);
      let gender = document.getElementById("pGender").value;
      let city = document.getElementById("pCity").value;
      let solar = document.getElementById("pSolar").value;

      let bazi = getBazi(year, month, day, hour);

      let result = `<h3>八字排盘结果</h3>`;
      result += `公历 ${year}年${month}月${day}日 ${hour}时<br>`;
      result += `性别：${gender} 出生地：${city||"未知"} 真太阳时：${solar}<br><br>`;
      result += `<b>年柱：</b>${bazi.year} <b>月柱：</b>${bazi.month} <b>日柱：</b>${bazi.day} <b>时柱：</b>${bazi.hour}<br><br>`;

      // 简单五行分布模拟
      let wuXing = {木:0,火:0,土:0,金:0,水:0};
      for(let k of Object.values(bazi)){
        if("甲乙寅卯".includes(k[0])||"寅卯".includes(k[1])) wuXing["木"]++;
        if("丙丁巳午".includes(k[0])||"巳午".includes(k[1])) wuXing["火"]++;
        if("戊己辰戌丑未".includes(k[0])||"辰戌丑未".includes(k[1])) wuXing["土"]++;
        if("庚辛申酉".includes(k[0])||"申酉".includes(k[1])) wuXing["金"]++;
        if("壬癸子亥".includes(k[0])||"子亥".includes(k[1])) wuXing["水"]++;
      }
      result += `<h3>五行分布</h3>`;
      for(let w in wuXing){
        let val = wuXing[w];
        if(val===0) result += `<span class="highlight-red">${w}:${val}（缺失）</span> `;
        else if(val>=2) result += `<span class="highlight-green">${w}:${val}（旺）</span> `;
        else result += `${w}:${val} `;
      }

      result += `<h3>喜用神建议</h3>`;
      result += `（简化示例）根据五行缺失或过旺，推测适合补充或克制的元素；缺木→宜接触木元素行业（教育、文化），缺火→科技、互联网；缺土→地产、管理；缺金→金融、法律；缺水→交通、旅游。<br>`;

      document.getElementById("personalResult").innerHTML = result;
    }

    function analyzeCompatibility() {
      let aYear = parseInt(document.getElementById("aYear").value);
      let aMonth = parseInt(document.getElementById("aMonth").value);
      let aDay = parseInt(document.getElementById("aDay").value);
      let aHour = parseInt(document.getElementById("aHour").value);

      let bYear = parseInt(document.getElementById("bYear").value);
      let bMonth = parseInt(document.getElementById("bMonth").value);
      let bDay = parseInt(document.getElementById("bDay").value);
      let bHour = parseInt(document.getElementById("bHour").value);

      let aBazi = getBazi(aYear, aMonth, aDay, aHour);
      let bBazi = getBazi(bYear, bMonth, bDay, bHour);

      let result = `<h3>合盘结果</h3>`;
      result += `甲方八字：${aBazi.year} ${aBazi.month} ${aBazi.day} ${aBazi.hour}<br>`;
      result += `乙方八字：${bBazi.year} ${bBazi.month} ${bBazi.day} ${bBazi.hour}<br><br>`;

      result += `<h3>相合/相冲分析</h3>`;
      result += `（示例逻辑）检查天干地支：若有冲（子午、卯酉等）则<span class="highlight-orange">提醒注意</span>，若有合（六合、三合局）则<span class="highlight-green">助力加分</span>。<br><br>`;
      result += `<h3>破解与落地建议</h3>`;
      result += `如果存在冲克，可通过选择合适的行业、颜色、月份来中和。例：火过旺→宜从事水相关行业，减少矛盾。<br>`;

      document.getElementById("compatibilityResult").innerHTML = result;
    }
  </script>
</body>
</html>
